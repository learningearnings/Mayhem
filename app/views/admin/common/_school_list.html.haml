%h2= person.name

= form_for [:admin,person],:url => "add_school_admin_#{person.type.underscore}".to_sym, :method => 'post' do |f|
  = select_tag :school_id, options_for_select(School.all.collect {|s| [s.name, s.id]}), :include_blank => true
  = f.submit (person.is_a?(Student) ? 'Change School' : 'Add School')

%h4 Schools
%table
  %thead
    %tr
      %th School Name
      %th Remove
  %tbody
    - person.schools.each do |school|
      %tr
        %td= link_to school.name, admin_school_path(school)
        %td= link_to 'Remove', delete_school_admin_teacher_path(:school_id => school.id, :teacher => person), :method => :delete

%h4 Accounts
%table
  %thead
    %tr
      %th Name
      %th Balance
      %th Add Credits
  %tbody
    - person.schools.each do |school|
      - person.accounts(school).each do |account|
        %tr
          %td= link_to account.name
          %td= account.balance
          %td{:style => "width: 400px;"}
            - if person.is_a?(Teacher) && account.name == person.main_account_name(school)
              = form_for [:admin, person], :url => give_credits_admin_teacher_path, :method => 'post' do |f|
                = f.hidden_field :school_id, :value => school.id
                = text_field :credits,:amount, :style => "width: 30%;"
                = f.submit 'Add Credits'
            - elsif person.is_a?(Student) && account.name == person.checking_account_name
              = form_for [:admin, person], :url => give_credits_admin_student_path, :method => 'post' do |f|
                = text_field :credits,:amount, :style => "width: 30%;"
                = f.submit 'Add Credits'


