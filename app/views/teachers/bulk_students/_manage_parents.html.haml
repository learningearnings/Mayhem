%h3= student.name
#tabs
  %ul
    %li
      %a{"href" => "#tab-1"} Parent Details
    %li
      %a{"href" => "#tab-2"} Parent Code

  #tab-1
    .parent-fields-section
      = simple_form_for @student, url: url_for(:controller => 'teachers/bulk_students', :action => 'manage_parents'), html: {:multipart => true}, remote: true do |f|
        = hidden_field_tag :student_id, student.id
        = hidden_field_tag :active_tab, tab_active(active_tab)
        .parent-list.clear
          .parent-header
            First Name
          .parent-header
            Last Name
          .parent-header
            Email
          .parent-header
            Username
          .parent-header
            Password
        = f.simple_fields_for :parents do |parent|
          = render 'parent_fields', f: parent  
        .clear  
          = link_to_add_association 'Add Parent', f, :parents, :wrap_object => Proc.new {|parent| parent.build_user; parent }
         
        = f.submit "Save", class: 'btn awesome-button add_students_button'

  #tab-2
    .parent-code-section
      .generated-code
        = "#{student.parent_token}"
      .image-parent-code
        = button_tag "Generate Parent Code", class: "noprint awesome-button", id: "parent-code-btn"
        = link_to "Print", print_parent_code_teachers_bulk_students_path(student_id:student.id, :format => :pdf),  class: "noprint awesome-button print-pdf"


:coffeescript
  $('#parent-code-btn').on 'click', (evt) ->
    evt.preventDefault()
    $.ajax '/teachers/bulk_students/manage_parents',
      type: 'POST',
      dataType: 'script',
      data: 
        student_id: $("#student_id").val()
        action_type: "generate_code" 
    return
  $(document).ready ->
    $('#tabs').tabs selected: $('#active_tab').val()
    return

