/*
Copyright (c) 2009 Google Inc. (Brad Neuberg, http://codinginparadise.org)

Portions Copyright (c) 2009 Rick Masters
Portions Copyright (c) 2009 Others (see COPYING.txt for details on
third party code)

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
*/
!function(){function _detectBrowsers(){var e=navigator,t=e.userAgent,n=e.appVersion,i=parseFloat(n);t.indexOf("Opera")>=0&&(isOpera=i);var s=Math.max(n.indexOf("WebKit"),n.indexOf("Safari"),0);s&&(isSafari=parseFloat(n.split("Version/")[1])||parseFloat(n.substr(s+7))>419.3?3:2),t.indexOf("AdobeAIR")>=0&&(isAIR=1),(n.indexOf("Konqueror")>=0||isSafari)&&(isKhtml=i),t.indexOf("Gecko")>=0&&!isKhtml&&(isMoz=i),isMoz&&(isFF=parseFloat(t.split("Firefox/")[1])||void 0),document.all&&!isOpera&&(isIE=parseFloat(n.split("MSIE ")[1])||void 0),t.indexOf("Chrome")>=0&&(isChrome=1),isStandardsMode=document.documentMode?document.documentMode>5:"CSS1Compat"==document.compatMode,"application/xhtml+xml"==document.contentType?isXHTML=!0:"undefined"!=typeof XMLDocument&&document.constructor==XMLDocument&&(isXHTML=!0),"undefined"!=typeof DOMParser&&"undefined"!=typeof XPathEvaluator&&"undefined"!=typeof XMLSerializer&&(hasDOMParser=!0,hasXMLSerializer=!0)}function doDebugging(){for(var e=!1,t=document.getElementsByTagName("script"),n=0;n<t.length;n++)if(/svg(?:\-uncompressed|\-[0-9a-fA-F]+)?\.js/.test(t[n].src)){var i=t[n].getAttribute("data-debug");e="true"===i||i===!0?!0:!1}return e}function flushQueue(){for(;queue.length;){var e=queue.shift();p=document.createElement("p"),p.appendChild(document.createTextNode(e)),document.body.appendChild(p)}}function extend(e,t){for(var n in t)e.prototype[n]=t[n]}function mixin(e,t){for(var n in t)e[n]=t[n]}function xpath(e,t,n,i){if(t||(t=e.documentElement),"undefined"!=typeof XPathEvaluator){for(var s,r=new XPathEvaluator,a=e.createNSResolver(t),o=r.evaluate(n,t,a,0,null),l=createNodeList();s=o.iterateNext();)l.push(s);return l}if(e.setProperty("SelectionLanguage","XPath"),i){for(var c="",d={},u=0;u<i.length;u++){var h=i[u],f=i["_"+h];d["_"+h]||(c+="xmlns"==f?'xmlns="'+h+'" ':"xmlns:"+f+'="'+h+'" ',d["_"+h]=h)}e.setProperty("SelectionNamespaces",c)}var l=t.selectNodes(n);(null===l||"undefined"==typeof l)&&(l=createNodeList());for(var p=createNodeList(),u=0;u<l.length;u++)p.push(l[u]);return p}function parseXML(e,t){void 0===t&&(t=!1);var n=parseXMLCache[t+e];if(n)return n.cloneNode(!0);var i;if(hasDOMParser){var s=new DOMParser;try{i=s.parseFromString(e,"application/xml")}catch(r){throw r}var a=i.documentElement;if("parsererror"==a.nodeName)throw new Error("There is a bug in your SVG: "+(hasXMLSerializer?(new XMLSerializer).serializeToString(a):a.xml))}else{for(var i,o=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.3.0"],l=0;l<o.length;l++)try{if(i=new ActiveXObject(o[l]))break}catch(r){}if(!i)throw new Error("Unable to instantiate XML parser");try{i.preserveWhiteSpace=t,i.resolveExternals=!1,i.validateOnParse=!1,i.setProperty("ProhibitDTD",!1),i.async="false";var c=i.loadXML(e);if(!c||0!==i.parseError.errorCode)throw new Error(i.parseError.reason)}catch(r){throw console.log(r.message),new Error("Unable to parse SVG: "+r.message)}}try{parseXMLCache[t+e]=i.cloneNode(!0)}catch(r){}return i}function xmlToStr(e,t){var n,i=e._nodeXML||e;hasXMLSerializer?n=(new XMLSerializer).serializeToString(i):i.xml?n=i.xml:"undefined"!=typeof XMLSerializer&&(n=(new XMLSerializer).serializeToString(i)),n=n.replace(/urn\:__fake__internal__namespace/g,svgns);var s="";if(-1==n.indexOf("xmlns=")&&(s='xmlns="'+svgns+'" '),t)for(var r=0;r<t.length;r++){var a=t[r],o=t["_"+a];a==svgnsFake&&(a=svgns);var l;l="xmlns"!=o?"xmlns:"+o+'="'+a+'"':'xmlns="'+a+'"',-1==n.indexOf(l)&&(s+=l+" ")}return n=n.replace(/<([^ ]+) /,"<$1 "+s)}function hitch(e,t){return"string"==typeof t&&(t=e[t]),function(){return t.apply(e,arguments.length?arguments:[])}}function xhrObj(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if(ActiveXObject){var e,t=null;for(e=0;e<XHR_PROGIDS.length&&!t;++e)try{t=new ActiveXObject(XHR_PROGIDS[e])}catch(n){}if(!t)throw new Error("XMLHttpRequest object not available on this platform");return t}}function guid(){return"_"+guidCounter++}function SVGWeb(){this._setXDomain(),this.libraryPath=this._getLibraryPath(),this.htcFilename=this._getHTCFilename(),isIE&&FlashHandler._prepareBehavior(this.libraryPath,this.htcFilename),this._interceptOnloadListeners(),this._initDOMContentLoaded()}function RenderConfig(){if(this._forceFlash())console.log("Forcing Flash SVG viewer for this browser");else if(this.hasNativeSVG())return this.supported=!0,this.use="native",void 0;var e=new FlashInfo;e.capable?e.isVersionOrAbove(10,0,0)?(this.supported=!0,this.use="flash"):(this.supported=!1,this.reason="Flash 10+ required"):(this.supported=!1,this.reason="Flash 10+ or a different browser required")}function FlashInfo(){this._detectVersion()}function FlashHandler(e){this.type=e.type,this._keyboardListeners=[],this._redrawManager=new _RedrawManager(this),"script"==this.type?(this.id=e.svgID,this._xml=e.xml,this._svgString=e.svgString,this._origSVG=e.origSVG,this._scriptNode=e.scriptNode):"object"==this.type&&(this.id=e.objID,this._objNode=e.objNode)}function NativeHandler(e){this.type=e.type,this._xml=e.xml,"object"==this.type?(this.id=e.objID,this._objNode=e.objNode):"script"==this.type&&(this.id=e.svgID,this._svgString=e.svgString,this._scriptNode=e.scriptNode)}function _RedrawManager(e){this._handler=e,this._batch=[],this._nextID=1,this._ids=[],this._timeoutIDs={}}function _DOMImplementation(){}function _Node(e,t,n,i,s,r){if(void 0!==e||void 0!==t){if(this.nodeName=e,this._nodeXML=s,this._handler=r,this._listeners={},this._detachedListeners=[],this.fake=!0,i==svgnsFake&&(i=svgns),t!=_Node.ELEMENT_NODE||this._nodeXML){if(t==_Node.DOCUMENT_FRAGMENT_NODE){var a='<?xml version="1.0"?>\n<__document__fragment></__document__fragment>';this._nodeXML=parseXML(a).documentElement}}else{var a='<?xml version="1.0"?>\n';a+=i!=svgns||n?"<"+e+" xmlns:"+n+'="'+i+'"/>':"<"+e+' xmlns="'+svgnsFake+'" xmlns:xlink="http://www.w3.org/1999/xlink"/>',this._nodeXML=parseXML(a).documentElement}t!=_Node.DOCUMENT_NODE&&this._nodeXML&&(this._nodeXML.getAttribute("__guid")||this._nodeXML.setAttribute("__guid",guid()),this._guid=this._nodeXML.getAttribute("__guid"),svgweb._guidLookup["_"+this._guid]=this),t==_Node.ELEMENT_NODE&&(this.localName=-1!=e.indexOf(":")?e.match(/^[^:]*:(.*)$/)[1]:e),this.nodeType=t?t:_Node.ELEMENT_NODE,t==_Node.ELEMENT_NODE||t==_Node.DOCUMENT_NODE||t==_Node.DOCUMENT_FRAGMENT_NODE?(this.prefix=n,this.namespaceURI=i,this._nodeValue=null):t==_Node.TEXT_NODE&&(this._nodeValue=this._nodeXML.firstChild.nodeValue,this.prefix=null,this.namespaceURI=null,void 0===this._nodeValue&&(this._nodeValue=null)),this.ownerDocument=document,this._handler&&"object"==this._handler.type&&(this.ownerDocument=this._handler.document),isIE&&this._createEmptyMethods(),this._childNodes=this._createChildNodes(),t==_Node.TEXT_NODE&&this._nodeXML.setAttribute("__fakeTextNode",!0),isIE?isIE&&this.nodeType!=_Node.DOCUMENT_NODE&&this._createHTC():this._defineNodeAccessors()}}function _Element(e,t,n,i,s){(void 0!==e||void 0!==n||void 0!==i||void 0!==s)&&(_Node.apply(this,[e,_Node.ELEMENT_NODE,t,n,i,s]),this._attributes={},this._attributes._id="",this._importAttributes(this,this._nodeXML),isIE||this._defineAccessors(),this.namespaceURI==svgns&&(isIE&&this._attached&&this._handler&&"script"==this._handler.type&&"svg"==this.nodeName||(this.style=new _Style(this)),isIE&&this._attached&&this._handler&&"script"==this._handler.type&&"svg"==this.nodeName||isIE&&(this.style._ignoreStyleChanges=!1)))}function _DocumentFragment(e){_Node.apply(this,["#document-fragment",_Node.DOCUMENT_FRAGMENT_NODE,null,null,null,null]),this.ownerDocument=e}function _Style(e){this._element=e,this._setup()}function _SVGObject(e,t){this._handler=t,this._svgNode=e,this._scriptsToExec=[],this._htcLoaded=Object.defineProperty?!0:!1,this._swfLoaded=!1;for(var n=0;this._svgNode._onloadListeners&&n<this._svgNode._onloadListeners.length;n++){var i=function(e,t){return function(){t.apply(e.flash)}}(this._handler,this._svgNode._onloadListeners[n]);svgweb.addOnLoad(i)}isIE&&this._loadHTC(),this.url=this._svgNode.getAttribute("src"),this.url||(this.url=this._svgNode.getAttribute("data"));var s=hitch(this,function(e){this._handler._origSVG=e;var t=svgweb._cleanSVG(e,!0,!1);this._svgString=t.svg,this._xml=t.xml,this.document=new _Document(this._xml,this._handler),this._handler.document=this.document,this._xml.documentElement,this._savedParams=this._getPARAMs(this._svgNode),this._handler._inserter=new FlashInserter("object",this._xml.documentElement,this._svgNode,this._handler)});"data:"==this.url.substring(0,5)?s(this.url.substring(this.url.indexOf(",")+1)):this._fetchURL(this.url,s,hitch(this,this._fallback))}function _SVGWindow(e){this._handler=e,this.fake=!0,this.frameElement=this._handler.flash,this.location=this._createLocation(),this.alert=window.alert,this.top=this.parent=window,this._onloadListeners=[]}function FlashInserter(e,t,n,i){this._embedType=e,this._nodeXML=t,this._replaceMe=n,this._handler=i,this._parentNode=n.parentNode,"object"==this._embedType&&(this._explicitWidth=this._replaceMe.getAttribute("width"),this._explicitHeight=this._replaceMe.getAttribute("height")),this._setupFlash()}function _SVGSVGElement(e,t,n,i){if(this._attached=!0,_Element.apply(this,["svg",null,svgns,e,i]),this._nodeXML=e,this._svgString=t,this._scriptNode=n,this._htcLoaded=Object.defineProperty?!0:!1,this._swfLoaded=!1,"script"==this._handler.type){var s=this._nodeXML.getAttribute("id"),r=this._handler.document;r._nodeById["_"+s]=this}this._currentScale=1,this._currentTranslate=this._createCurrentTranslate(),isIE&&"script"==this._handler.type?(this._addRedrawMethods(),this.style=new _Style(this),this._readyStateListener=hitch(this,this._onHTCLoaded),this._htcNode.attachEvent("onreadystatechange",this._readyStateListener)):isIE&&"object"==this._handler.type&&this._addRedrawMethods(),"script"==this._handler.type&&(this._handler._inserter=new FlashInserter("script",this._nodeXML,this._scriptNode,this._handler))}function _Document(e,t){_Node.apply(this,["#document",_Node.DOCUMENT_NODE,null,null,e,t],svgns),this._xml=e,this._handler=t,this._nodeById={},this._namespaces=this._getNamespaces(),this.implementation=new _DOMImplementation,"script"==this._handler.type&&(this.defaultView=window)}function createNodeList(){var e=[];return e.item=function(e){return e>=this.length?null:this[e]},e}function createCharacterData(e){var t=void 0!==e?new String(e):new String;return t.data=t.toString(),t}function _SVGMatrix(e,t,n,i,s,r,a){this.a=e,this.b=t,this.c=n,this.d=i,this.e=s,this.f=r,this._handler=a}function _SVGLength(e){this.value=e}function _SVGAnimatedLength(e){this.baseVal=e,this.animVal=void 0}function _SVGTransform(e,t,n){this.type=e,this.matrix=t,this.angle=n}function _SVGPoint(e,t,n,i){void 0===n&&(n=!1),this._formalAccessors=n,this.x=e,this.y=t,n&&(this.setX=hitch(this,function(e){this.x=e,i("x",e)}),this.getX=hitch(this,function(){return this.x}),this.setY=hitch(this,function(e){this.y=e,i("y",e)}),this.getY=hitch(this,function(){return this.y}),this.setXY=hitch(this,function(e,t){this.x=e,this.y=t,i("xy",e,t)}))}function _SVGRect(e,t,n,i){this.x=e,this.y=t,this.width=n,this.height=i}window.svgns="http://www.w3.org/2000/svg",window.xlinkns="http://www.w3.org/1999/xlink",svgnsFake="urn:__fake__internal__namespace";var isOpera=!1,isSafari=!1,isMoz=!1,isIE=!1,isAIR=!1,isKhtml=!1,isFF=!1,isXHTML=!1,isChrome=!1,hasDOMParser=!1,hasXMLSerializer=!1;_detectBrowsers();var debug=doDebugging();if("undefined"==typeof console||!console.log){var queue=[];if(console={},debug){if(console.log=function(e){var t=null,n=!1;try{t=document.getElementsByTagName("body")[0]}catch(i){n=!0}if(isIE)try{document.documentElement.doScroll("left")}catch(i){n=!0}if(n)return queue.push(e),void 0;for(var s;queue.length;){var r=queue.shift();s=document.createElement("p"),s.appendChild(document.createTextNode(r)),t.appendChild(s)}s=document.createElement("p"),s.appendChild(document.createTextNode(e)),t.appendChild(s)},isIE)var debugInterval=window.setInterval(function(){"complete"==document.readyState&&(flushQueue(),window.clearTimeout(debugInterval))},50)}else console.log=function(){}}var parseXMLCache={},XHR_PROGIDS=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],guidCounter=0;extend(SVGWeb,{libraryPath:"./",config:null,pageLoaded:!1,handlers:[],totalLoaded:0,_guidLookup:[],_loadListeners:[],_removedNodes:[],_allSVGNamespaces:[],addOnLoad:function(e,t,n){if(t){var i;if(n.frameElement)i=n.frameElement;else{var s;for(s=0;s<this.handlers.length;s++)this.handlers[s]._objNode&&this.handlers[s]._objNode.contentDocument&&this.handlers[s]._objNode.contentDocument.defaultView==n&&(i=this.handlers[s]._objNode)}t&&"flash"==this.getHandlerType()?e.apply(n):i._svgHandler?i._svgHandler._onObjectLoad(e,n):(i._svgWindow=n,i._svgFunc=e)}else this._loadListeners.push(e);this.pageLoaded&&this._fireOnLoad()},getHandlerType:function(){return this.renderer==FlashHandler?"flash":this.renderer==NativeHandler?"native":void 0},appendChild:function(e,t){if("object"==e.nodeName.toLowerCase()&&"image/svg+xml"==e.getAttribute("type")){this.totalSVG++,this._svgObjects.push(e),"native"==this.getHandlerType()&&(e.onload=e.onsvgload,t.appendChild(e));var n=e;if("flash"==this.getHandlerType()){e.onsvgload&&e.addEventListener("SVGLoad",e.onsvgload,!1);for(var i=document._createElement("div"),s=0;s<e.attributes.length;s++){var r=e.attributes[s],a=r.nodeName,o=r.nodeValue;(o||"true"===o)&&i.setAttribute(a,o)}t.appendChild(i),i._onloadListeners=e._onloadListeners,n=i}var l=this._processSVGObject(n);e._objID=l}else if("svg"==e.nodeName.toLowerCase()){this.totalSVG++,e.onsvgload&&e.addEventListener("SVGLoad",e.onsvgload,!1),isIE&&e._fakeNode&&(e=e._fakeNode);var c=xmlToStr(e),d=document.createElement("script");if(d.type="image/svg+xml",isXHTML)d.appendChild(document.createTextNode(c));else try{d.appendChild(document.createTextNode(c))}catch(u){d.text=c}this._svgScripts.push(d),t.appendChild(d),d._onloadListeners=e._detachedListeners||e._onloadListeners,this._processSVGScript(d)}},removeChild:function(e,t){var n,i,s=e.nodeName.toLowerCase();if("object"==s||"embed"==s||"svg"==s){this.totalSVG=0==this.totalSVG?0:this.totalSVG-1,this.totalLoaded=0==this.totalLoaded?0:this.totalLoaded-1,n=e.id,i=this.handlers[n];for(var r=[],a=0;a<this.handlers.length;a++){var o=this.handlers[a];o!=i&&(r[o.id]=o,r.push(o))}this.handlers=r}if("object"==s||"embed"==s){if("flash"==this.getHandlerType()&&i.document&&i.document.defaultView){var l=i.document.defaultView;if(l._intervalIDs)for(var a=0;a<l._intervalIDs.length;a++)l.clearInterval(l._intervalIDs[a]);if(l._timeoutIDs)for(var a=0;a<l._timeoutIDs.length;a++)l.clearTimeout(l._timeoutIDs[a]);for(var a=0;a<i._keyboardListeners.length;a++){var c=i._keyboardListeners[a];isIE?(document.detachEvent("onkeydown",c),document.detachEvent("onkeyup",c)):(document.removeEventListener("keydown",c,!0),document.removeEventListener("keydown",c,!1),document.removeEventListener("keyup",c,!0),document.removeEventListener("keyup",c,!1))}}var d;d="undefined"!=typeof e._objID?e._objID:"undefined"!=typeof e.contentDocument?e.contentDocument._handler.id:e._handler.id;for(var a=0;a<svgweb._svgObjects.length;a++)if(svgweb._svgObjects[a]._objID===d){svgweb._svgObjects.splice(a,1);break}if(t.removeChild(e),"flash"==this.getHandlerType()){var u=document.getElementById("__htc_container");if(u)for(var a=0;a<u.childNodes.length;a++){var h=u.childNodes[a];"undefined"!=typeof h.ownerDocument&&h.ownerDocument==i._svgObject.document&&("undefined"!=typeof h._fakeNode&&"undefined"!=typeof h._fakeNode._htcNode&&(h._fakeNode._htcNode=null),h._fakeNode=null,h._handler=null,u.removeChild(h))}for(var f in svgweb._guidLookup){var h=svgweb._guidLookup[f];h._fake&&h.ownerDocument===i.document&&delete svgweb._guidLookup[f]}i.flash.contentDocument=null,i.flash=null,i._xml=null,i.window&&(i.window._scope=null,i.window=null);var p=i._svgObject,g=p.document;g._nodeById=null,g._xml=null,g.defaultView=null,g.documentElement=null,g.rootElement=null,g.defaultView=null,g=null,p._svgNode=null,p._handler=null,l&&(l._setTimeout=null,l.setTimeout=null,l._setInterval=null,l.setInterval=null),i._svgObject=null,p=null,i=null,l=null}}else if("svg"==s){for(var a=0;a<svgweb._svgScripts.length;a++)if(svgweb._svgScripts[a]==i._scriptNode){svgweb._svgScripts.splice(a,1);break}isIE&&"flash"==this.getHandlerType()&&e._fakeNode&&(e=e._fakeNode);var m;if(m="native"==this.getHandlerType()?e:e._handler.flash,isIE?window.setTimeout(function(e,t){return function(){e.removeChild(t),e=null,t=null}}(t,m),1):t.removeChild(m),"flash"==this.getHandlerType()){e._setUnattached();for(var f in svgweb._guidLookup){var h=svgweb._guidLookup[f];h._fake&&h._getFakeNode()===i&&delete svgweb._guidLookup[f]}i._scriptNode=null,i.flash.documentElement=null,i.flash=null,i._xml=null,i=null}}},_initDOMContentLoaded:function(){var e=this;if(document.addEventListener)document.addEventListener("DOMContentLoaded",function(){e._onDOMContentLoaded()},!1);else{document.write('<script id="__ie__svg__onload" defer src=//0></script>');var t=document.getElementById("__ie__svg__onload");t.onreadystatechange=function(){"complete"==this.readyState&&e._onDOMContentLoaded()};var n=function(){window.onload&&(e._saveWindowOnload(),document.detachEvent("onreadystatechange",n))};document.attachEvent("onreadystatechange",n)}},_setXDomain:function(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++)if(/svg(?:\-uncompressed|\-[0-9a-fA-F]+)?\.js/.test(e[t].src)&&/^https?/.test(e[t].src)){var n=e[t].src.replace(/svg(?:\-uncompressed|\-[0-9a-fA-F]+)?\.js/,""),i=n.match(/https?\:\/\/[^\/]*/)[0],s=window.location.protocol.replace(/:|\//g,"")+"://"+window.location.host;if(i!=s)return this.xDomainURL=n,this._isXDomain=!0,void 0}this._isXDomain=!1},_getLibraryPath:function(){for(var e=null,t=document.getElementsByTagName("meta"),n=0;n<t.length;n++)"svg.config.data-path"==t[n].name&&t[n].content.length>0&&(e=t[n].content);for(var i=document.getElementsByTagName("script"),n=0;n<i.length;n++)if(/svg(?:\-uncompressed|\-[0-9a-fA-F]+)?\.js/.test(i[n].src)){if(i[n].getAttribute("data-path"))e=i[n].getAttribute("data-path");else if(null===e){var s=i[n].getAttribute("src"),r=s.split("/");r.length=r.length-1,e=r.join("/")}break}return null===e&&(e="./"),"/"!=e.charAt(e.length-1)&&(e+="/"),e},_getHTCFilename:function(){var e="svg.htc",t=window.location.toString();if(-1!=t.indexOf("svg.htcFilename=svg-htc.php"))return"svg-htc.php";if(-1!=t.indexOf("svg.htcFilename=svg-htc.jsp"))return"svg-htc.jsp";if(-1!=t.indexOf("svg.htcFilename=svg-htc.asp"))return"svg-htc.asp";for(var n=document.getElementsByTagName("script"),i=0;i<n.length;i++)if(/svg(?:\-uncompressed|\-[0-9a-fA-F]+)?\.js/.test(n[i].src)&&n[i].getAttribute("data-htc-filename")){e=n[i].getAttribute("data-htc-filename");break}return e},_onDOMContentLoaded:function(){if(!arguments.callee.done){arguments.callee.done=!0,this._startTime=(new Date).getTime();var e=document.getElementById("__ie__svg__onload");if(e&&(e.parentNode.removeChild(e),e.onreadystatechange=null,e=null),this._saveWindowOnload(),this.config=new RenderConfig,isIE&&this._watchUnload(),this._svgScripts=this._getSVGScripts(),this._svgObjects=this._getSVGObjects(),this.totalSVG=this._svgScripts.length+this._svgObjects.length,this._cleanupSVGObjects(),this._handleHTMLTitleBug(),!this.config.supported)return this._displayNotSupported(this.config.reason),this._fireOnLoad(),void 0;if("flash"==this.config.use?this.renderer=FlashHandler:"native"==this.config.use&&(this.renderer=NativeHandler),this.renderer._patchBrowserObjects(window,document),this.renderer.documentRef=document,"flash"==this.config.use&&(this._createResizeListener(),this._attachResizeListener()),0===this.totalSVG)return this._fireOnLoad(),void 0;for(var t=0;t<this._svgScripts.length;t++)this._processSVGScript(this._svgScripts[t]);for(var t=0;t<this._svgObjects.length;t++){var n=this._processSVGObject(this._svgObjects[t]);this._svgObjects[t]._objID=n}}},_createResizeListener:function(){this._resizeFunc=isIE?function(e){return function(){e._onWindowResize()}}(this):hitch(this,function(){this._onWindowResize()})},_attachResizeListener:function(){isIE?window.attachEvent("onresize",this._resizeFunc):window.addEventListener("resize",this._resizeFunc,!1)},_detachResizeListener:function(){isIE?window.detachEvent("onresize",this._resizeFunc):window.removeEventListener("resize",this._resizeFunc,!1)},_onWindowResize:function(){if(this.pageLoaded){this._detachResizeListener();for(var e=0;e<this.handlers.length;e++){var t=this.handlers[e];if(t._inserter&&t.flash&&t._loaded){var n=t._inserter._determineSize();t.flash.width=n.width,t.flash.height=n.height,t.sendToFlash("jsHandleResize",[n.pixelsWidth,n.pixelsHeight])}}this._attachResizeListener()}},_getSVGScripts:function(){for(var e=document.getElementsByTagName("script"),t=[],n=0;n<e.length;n++)"image/svg+xml"==e[n].type&&t.push(e[n]);return t},_getSVGObjects:function(){for(var e=document.getElementsByTagName("object"),t=[],n=0;n<e.length;n++)"image/svg+xml"==e[n].getAttribute("classid")?t.push(e[n]):"image/svg+xml"==e[n].getAttribute("type")&&t.push(e[n]);return t},_displayNotSupported:function(e){for(var t=0;t<this._svgObjects.length;t++){var n=this._svgObjects[t];if(!n.childNodes.length||1==n.childNodes.length&&3==n.childNodes[0].nodeType&&/^[ ]*$/m.test(n.childNodes[0].nodeValue)){var i=document.createElement("span");i.className="svg-noscript",i.appendChild(document.createTextNode(e)),n.parentNode.replaceChild(i,n)}}for(var t=0;t<this._svgScripts.length;t++){var s=this._svgScripts[t],r=document.createElement("span");r.className="svg-noscript";for(var a=s.nextSibling;a&&1!=a.nodeType;)a=a.nextSibling;if(a&&"noscript"==a.nodeName.toLowerCase()){var o=a;r.innerHTML=o.innerHTML}else r.appendChild(document.createTextNode(e));s.parentNode.insertBefore(r,s)}},_fireOnLoad:function(){if(!(this.handlers.length<this._svgObjects.length)){for(var e=!0,t=0;t<this.handlers.length;t++){var n=this.handlers[t];if(!n._loaded){e=!1;break}}if(e&&(this.pageLoaded=!0,this._endTime=(new Date).getTime(),this._loadListeners.length)){var i=this;window.setTimeout(function(){var e=i._loadListeners;i._loadListeners=[],this.totalLoaded=0;for(var t=0;t<e.length;t++)try{e[t]()}catch(n){console.log("Error while firing onload: "+(n.message||n))}},1)}}},_cleanSVG:function(e,t,n){/^\s*<\!\[CDATA\[/.test(e)&&(e=e.replace(/^\s*<\!\[CDATA\[/,""),e=e.replace(/\]\]>\s*/,"")),RegExp.lastIndex=0;for(var i,s=/<!ENTITY\s+(\S+)\s+"([^"]*)"/g;null!=(i=s.exec(e));){var r=RegExp.$1,a=RegExp.$2;e=e.split("&"+r+";").join(a)}if(t&&(0==/\<\?xml/m.test(e)&&(e='<?xml version="1.0"?>\n'+e),0==/xmlns:[^=]+=['"]http:\/\/www\.w3\.org\/1999\/xlink['"]/.test(e)&&(e=e.replace("<svg",'<svg xmlns:xlink="http://www.w3.org/1999/xlink"')),0==/xmlns\=['"]http:\/\/www\.w3\.org\/2000\/svg['"]/.test(e)&&(e=e.replace("<svg",'<svg xmlns="http://www.w3.org/2000/svg"'))),"<"!=e.charAt(0)&&(e=e.replace(/\s*<\?xml/,"<?xml")),n&&(e=e.replace(/\>\s+\</gm,"><")),this.renderer==FlashHandler){e=e.replace(/<!\-\-[\s\S]*?\-\->/g,""),e=e.replace(/<svg/,"<SVGROOT"),e=e.replace(/<svg/g,"<NESTEDSVG"),e=e.replace(/<SVGROOT/,"<svg");var o=e.match(/<svg/)[0],l=e.split(/<svg/),c=-1!=l[1].indexOf("<![CDATA[");if(c){RegExp.lastIndex=0;var d=/<\!\[CDATA\[/g;i=d.exec(l[1]);var u=[];for(_=0;i&&RegExp.rightContext;){var h=d.lastIndex-"<![CDATA[".length,f=RegExp.rightContext,p=d.lastIndex+f.indexOf("]]>")+2,g=f.substring(0,f.indexOf("]]>"));g="<![CDATA["+g+"]]>",u.push(g);var m=l[1].substring(0,h),v=l[1].substring(p+1,l[1].length);l[1]=m+"__SVG_CDATA_TOKEN_"+_+v,i=d.exec(l[1]),_++}}if(l[1]=l[1].replace(/>([^<]+)</g,"><__text>$1</__text><"),c)for(var _=0;_<u.length;_++)l[1]=l[1].replace("__SVG_CDATA_TOKEN_"+_,u[_]);e=l[0]+o+l[1];for(var _=2;_<l.length;_++)e+=l[_]}e=e.replace(/<NESTEDSVG/g,"<svg"),this.renderer==FlashHandler&&(e=FlashHandler._encodeFlashData(e),e=e.replace(/xmlns(\:[^=]*)?=['"]http\:\/\/www\.w3\.org\/2000\/svg['"]/g,'xmlns$1="'+svgnsFake+'"'));var b=this._addTracking(e,n);return e=hasXMLSerializer?(new XMLSerializer).serializeToString(b):b.xml,this.renderer==FlashHandler&&(e=e.replace(new RegExp(svgnsFake,"g"),svgns)),{svg:e,xml:b}},_processSVGScript:function(e){var t;if(isXHTML){t="";for(var n=0;n<e.childNodes.length;n++)t+=e.childNodes[n].textContent}else t=e.innerHTML;var i=this._cleanSVG(t,!0,!0),s=i.svg,r=i.xml,a=r.documentElement.getAttribute("id"),o=r.documentElement.getAttribute("onload");if(o){var l='var evt = { target: document.getElementById("'+a+'") ,'+'currentTarget: document.getElementById("'+a+'") ,'+"preventDefault: function() { this.returnValue=false; }"+"};";o=new Function(l+o);var c=function(e,t){return function(){var n,i=svgweb.handlers[t];return n="flash"==svgweb.getHandlerType()?i.document.documentElement._getProxyNode():document.getElementById(t),e.apply(n)}}(o,a);this._loadListeners.push(c)}var d=new this.renderer({type:"script",svgID:a,xml:r,svgString:s,origSVG:t,scriptNode:e});this.handlers[a]=d,this.handlers.push(d),d.start()},_processSVGObject:function(e){var t=e.getAttribute("id");t||(e.setAttribute("id",svgweb._generateID("__svg__random__","__object")),t=e.getAttribute("id"));var n=new this.renderer({type:"object",objID:t,objNode:e});return this.handlers[t]=n,this.handlers.push(n),n.start(),t},_generateID:function(e,t){return t||(t=""),e||(e=""),e+guid()+t},_addTracking:function(e,t){var n=!t,i=parseXML(e,n),s=i.documentElement;if(s&&!s.getAttribute("id")&&s.setAttribute("id",this._generateID("__svg__random__",null)),"flash"!=this.getHandlerType())return i;for(var r=s;r;){r.nodeType==_Node.ELEMENT_NODE&&r.setAttribute("__guid",guid()),r.nodeType!=_Node.ELEMENT_NODE||r.getAttribute("id")||r.setAttribute("id",svgweb._generateID("__svg__random__",null));var a=r.firstChild;if(a)r=a;else for(;r;){if(r!=s&&(a=r.nextSibling)){r=a;break}r==s?r=null:(r=r.parentNode,1!=r.nodeType&&(r=null))}}return i},_handleDone:function(e,t,n){if(this.totalLoaded++,"script"==t&&n._scriptNode._onloadListeners){for(var i=0;i<n._scriptNode._onloadListeners.length;i++){var s=n._scriptNode._onloadListeners[i];if("flash"==svgweb.getHandlerType())s=s.listener;else{var r=n._svgRoot.addEventListener.toString();-1!=r.indexOf("[native code]")&&NativeHandler._patchAddEventListener(n._svgRoot)}try{var a=document.getElementById(n.id);isOpera?setTimeout(function(){s.apply(a),s=null,a=null},1):s.apply(a)}catch(o){console.log("Error while firing onload listener: "+o.message||o)}}n._scriptNode._onloadListeners=[]}this.totalLoaded>=this.totalSVG&&this._fireOnLoad()},_handleHTMLTitleBug:function(){var e=document.getElementsByTagName("head")[0],t=e.getElementsByTagName("title");0===t.length&&(t=document.createElement("title"),e.appendChild(t))},_fireFlashError:function(){},_exportID:function(e){e.__defineGetter__("id",function(){return e.getAttribute("id")}),e.__defineSetter__("id",function(t){return e.setAttribute("id",t)})},_watchUnload:function(){window.attachEvent("onunload",function(){window.detachEvent("onunload",arguments.callee),svgweb._fireUnload()})},_fireUnload:function(){if(isIE){for(var e=0;e<svgweb.handlers.length;e++)if("object"==svgweb.handlers[e].type){var t=svgweb.handlers[e].flash;t&&t.parentNode&&svgweb.removeChild(t,t.parentNode)}else svgweb.handlers[e].document.documentElement=null;var n=document.getElementById("__htc_container");if(n){for(var e=0;e<n.childNodes.length;e++){var i=n.childNodes[e];1==i.nodeType&&i.namespaceURI==svgns&&(i.detachEvent("onpropertychange",i._fakeNode.style._changeListener),i.style.item=null,i.style.setProperty=null,i.style.getPropertyValue=null),i._fakeNode&&(i._fakeNode._htcNode=null),i._fakeNode=null,i._handler=null}n.parentNode.removeChild(n),n=null}for(var e=0;e<svgweb.handlers.length;e++){var s=svgweb.handlers[e];s.flash=null}svgweb.handlers=null;for(var e=0;e<svgweb._removedNodes.length;e++){var r=svgweb._removedNodes[e];r._fakeNode&&(r._fakeNode._htcNode=null),r._fakeNode=null,r._handler=null}svgweb._removedNodes=null,document.getElementById=document._getElementById,document._getElementById=null,document.getElementsByTagNameNS=document._getElementsByTagNameNS,document._getElementsByTagNameNS=null,document.createElementNS=document._createElementNS,document._createElementNS=null,document.createElement=document._createElement,document._createElement=null,document.createTextNode=document._createTextNode,document._createTextNode=null,document._importNodeFunc=null,document.createDocumentFragment=document._createDocumentFragment,document._createDocumentFragment=null,window.addEventListener=null,window._addEventListener=null,window.attachEvent=window._attachEvent,window._attachEvent=null,parseXMLCache=null}},_cleanupSVGObjects:function(){if("flash"==this.config.use&&this.config.hasNativeSVG())for(var e=0;e<this._svgObjects.length;e++){for(var t=this._svgObjects[e],n=document.createElement("div"),i=0;i<t.attributes.length;i++){var s=t.attributes[i];n.setAttribute(s.nodeName,s.nodeValue)}var r=t.innerHTML;n.innerHTML=r,t.parentNode.replaceChild(n,t),this._svgObjects[e]=n}for(var e=0;e<this._svgObjects.length;e++)this._svgObjects[e].style.visibility="hidden"},_interceptOnloadListeners:function(){window.addEventListener?(window._addEventListener=window.addEventListener,window.addEventListener=function(e,t,n){return"svgload"!=e.toLowerCase()?window._addEventListener(e,t,n):(svgweb.addOnLoad(t),void 0)}):window.addEventListener=function(e,t){if("svgload"==e.toLowerCase())svgweb.addOnLoad(t);else if(isIE&&window.attachEvent)return window.attachEvent("on"+e,t)},isIE&&window.attachEvent&&(window._attachEvent=window.attachEvent,window.attachEvent=function(e,t){return"onsvgload"!=e.toLowerCase()?window._attachEvent(e,t):(svgweb.addOnLoad(t),void 0)})},_saveWindowOnload:function(){var onsvgload=window.onsvgload;if(document.getElementsByTagName("body")){var body=document.getElementsByTagName("body")[0];body.getAttribute("onsvgload")&&(callbackStr=body.getAttribute("onsvgload"),onsvgload=function(callbackStr){return function(){eval(callbackStr)}}(callbackStr))}onsvgload&&(isIE?this._loadListeners.splice(0,0,onsvgload):this._loadListeners.push(onsvgload),window.onsvgload=onsvgload=null)}}),extend(RenderConfig,{supported:!1,reason:null,use:null,_forceFlash:function(){for(var e=!1,t=!1,n=document.getElementsByTagName("meta"),i=0;i<n.length;i++)"svg.render.forceflash"==n[i].name&&"true"==n[i].content.toLowerCase()&&(e=!0,t=!0);return-1!=window.location.search.indexOf("svg.render.forceflash=true")?e=!0:t&&-1!=window.location.search.indexOf("svg.render.forceflash=false")&&(e=!1),e},hasNativeSVG:function(){return document.implementation&&document.implementation.hasFeature?document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"):!1}}),FlashInfo.prototype={version:-1,versionMajor:-1,versionMinor:-1,versionRevision:-1,capable:!1,isVersionOrAbove:function(e,t,n){return n=parseFloat("."+n),this.versionMajor>=e&&this.versionMinor>=t&&this.versionRevision>=n?!0:!1},_detectVersion:function(){for(var e,t=25;t>0;t--){if(isIE){var n;try{n=t>6?new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+t):new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),"object"==typeof n&&(6==t&&(n.AllowScriptAccess="always"),e=n.GetVariable("$version"))}catch(i){continue}}else e=this._JSFlashInfo(t);if(-1==e)return this.capable=!1,void 0;if(0!==e){var s;if(isIE){var r=e.split(" "),a=r[1];s=a.split(",")}else s=e.split(".");this.versionMajor=s[0],this.versionMinor=s[1],this.versionRevision=s[2];var o=this.versionMajor+"."+this.versionRevision;this.version=parseFloat(o),this.capable=!0;break}}},_JSFlashInfo:function(){if(null!==navigator.plugins&&navigator.plugins.length>0&&(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"])){var e=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"",t=navigator.plugins["Shockwave Flash"+e].description,n=t.split(" "),i=n[2].split("."),s=i[0],r=i[1],a=(n[3]||n[4]).split("r"),o=a[1]>0?a[1]:0,l=s+"."+r+"."+o;return l}return-1}},FlashHandler._keyboardListeners=[],FlashHandler._unattachedDoc=parseXML('<?xml version="1.0"?>\n<svg xmlns="'+svgns+'"></svg>',!1),FlashHandler._prepareBehavior=function(e,t){for(var n=null,i=0;i<document.namespaces.length;i++)if("svg"==document.namespaces.item(i).name){n=document.namespaces.item(i);break}null===n&&(n=document.namespaces.add("svg",svgns)),n.doImport(e+t)},FlashHandler._getNode=function(e,t){var n;n=svgweb._guidLookup["_"+e.getAttribute("__guid")];var i=!1;if(n||"__text"!=e.nodeName||(i=!0),n||i||e.nodeType!=_Node.ELEMENT_NODE)if(n||e.nodeType!=_Node.TEXT_NODE&&!i){if(!n)throw new Error("Unknown node type given to _getNode: "+e.nodeType)}else n=new _Node("#text",_Node.TEXT_NODE,null,null,e,t);else n=new _Element(e.nodeName,e.prefix,e.namespaceURI,e,t);
return n._getProxyNode()},FlashHandler._patchBrowserObjects=function(e,t){t._getElementById||(t._getElementById=t.getElementById,t.getElementById=FlashHandler._getElementById,t._getElementsByTagNameNS=t.getElementsByTagNameNS,t.getElementsByTagNameNS=FlashHandler._getElementsByTagNameNS,t._createElementNS=t.createElementNS,t.createElementNS=FlashHandler._createElementNS,t._createElement=t.createElement,t.createElement=FlashHandler._createElement,t._createTextNode=t.createTextNode,t.createTextNode=FlashHandler._createTextNode,t._importNodeFunc=FlashHandler._importNodeFunc,t._createDocumentFragment=t.createDocumentFragment,t.createDocumentFragment=FlashHandler._createDocumentFragment,t._addEventListener=t.addEventListener,t.addEventListener=FlashHandler._addEventListener)},FlashHandler._patchFakeObjects=function(e,t){t._addEventListener=t.addEventListener,t.addEventListener=FlashHandler._addEventListener},FlashHandler._addEventListener=function(e,t,n){if("key"==e.substring(0,3)){var i=function(e){return function(t){t.preventDefault||(t.preventDefault=function(){this.returnValue=!1,t=null}),"object"==typeof e?e.handleEvent.call(e,t):e(t)}}(t);i.__type=e,i.__listener=t,i.__useCapture=n,this._handler?this._handler._keyboardListeners.push(i):FlashHandler._keyboardListeners.push(i)}this._addEventListener?this._addEventListener(e,t,n):this.attachEvent&&this.attachEvent("on"+e,t)},FlashHandler._getElementById=function(e){var t=document._getElementById(e);if(null!==t)return t;for(var n=0;n<svgweb.handlers.length;n++)if("script"==svgweb.handlers[n].type&&(t=svgweb.handlers[n].document.getElementById(e)),t)return t;return null},FlashHandler._getElementsByTagNameNS=function(e,t){var n=createNodeList();if(document._getElementsByTagNameNS)for(var i=document._getElementsByTagNameNS(e,t),s=0;s<i.length;s++)n.push(i[s]);for(var r=0;r<svgweb.handlers.length;r++)if("script"==svgweb.handlers[r].type)for(var a=svgweb.handlers[r].document,i=a.getElementsByTagNameNS(e,t),s=0;s<i.length;s++)n.push(i[s]);return n},FlashHandler._createElementNS=function(e,t,n){if(void 0===n&&(n=!1),null===e||"http://www.w3.org/1999/xhtml"==e)return isIE?document.createElement(t):document._createElementNS(e,t);var i=!1;if(e==svgns&&(e=svgnsFake,i=!0),!isIE&&!n){svgweb._allSVGNamespaces["_"+e]&&(i=!0);for(var s=0;!i&&s<svgweb.handlers.length;s++)if("script"==svgweb.handlers[s].type&&svgweb.handlers[s].document._namespaces["_"+e]){i=!0;break}if(!i)return document._createElementNS(e,t)}var r;if(svgweb._allSVGNamespaces["_"+e])r=svgweb._allSVGNamespaces["_"+e];else for(var s=0;s<svgweb.handlers.length&&("script"!=svgweb.handlers[s].type||!(r=svgweb.handlers[s].document._namespaces["_"+e]));s++);"xmlns"!=r&&r||(r=-1!=t.indexOf(":")?t.substring(0,t.indexOf(":")):null);var a=new _Element(t,r,e);return a._getProxyNode()},FlashHandler._createElement=function(e,t){if(!t)return document._createElement(e);if(t&&"object"==e.toLowerCase()){var n=document._createElement("object");n._onloadListeners=[];var i=n.addEventListener;return function(e,t){e.addEventListener=function(e,n,s){"svgload"==e.toLowerCase()?this._onloadListeners.push(n):i?t(e,n,s):this.attachEvent("on"+e,n)}}(n,i),n}},FlashHandler._createTextNode=function(e,t){if(t){var n,i=FlashHandler._unattachedDoc;n=isIE?i.createElement("__text"):i.createElementNS(svgnsFake,"__text"),n.appendChild(i.createTextNode(e));var s=new _Node("#text",_Node.TEXT_NODE,null,null,n);return s._nodeValue=e,s.ownerDocument=document,s._getProxyNode()}return document._createTextNode(e)},FlashHandler._importNodeFunc=function(e,t,n){switch(t.nodeType){case 1:var i=e.createElement(t.nodeName);if(t.attributes&&t.attributes.length>0)for(var s=0;s<t.attributes.length;s++){var r=t.attributes[s].nodeName,a=t.getAttribute(r);i.setAttribute(r,a)}if(n&&t.childNodes&&t.childNodes.length>0)for(var s=0;s<t.childNodes.length;s++)i.appendChild(document._importNodeFunc(e,t.childNodes[s],n));return i;case 3:return e.createTextNode(t.nodeValue)}},FlashHandler._createDocumentFragment=function(e){return e?new _DocumentFragment(document)._getProxyNode():document._createDocumentFragment()},FlashHandler._encodeFlashData=function(e){return e=e.toString().replace(/\\/g,"\\\\"),e=e.replace(/&/g,"__SVG__AMPERSAND")},extend(FlashHandler,{flashID:null,flash:null,start:function(){"script"==this.type?this._handleScript():"object"==this.type&&this._handleObject()},_stringToMsg:function(e){if(null==e||"string"!=typeof e)return e;for(var t={},n=e.split(/__SVG__DELIMIT/g),i=0;i<n.length;i++){var s=n[i].indexOf(":"),r=n[i].substring(0,s),a=n[i].substring(s+1);"true"===a?a=!0:"false"===a?a=!1:"null"===a?a=null:"undefined"===a&&(a=void 0),t[r]=a}return t},debugMsg:function(e){if(void 0===e)return"undefined";if(null===e)return"null";var t=[];for(var n in e)t.push(n+":"+e[n]);return t=t.join(", "),"{"+t+"}"},sendToFlash:function(e,t){var n=t.join("__SVG__DELIMIT");if(this._redrawManager.isSuspended())this._redrawManager.batch(e,n);else try{return"undefined"==typeof this.flash[e]&&__flash__addCallback(this.flash,e),this.flash[e](n)}catch(i){console.log("Call to flash but flash is not present! "+e+": "+this.debugMsg(n)+": "+i)}},onMessage:function(e){return e=this._stringToMsg(e),"event"==e.type?(this._onEvent(e),void 0):"log"==e.type?(this._onLog(e),void 0):"script"==e.type?(this._onObjectScript(e),void 0):"viewsource"==e.type?(this._onViewSource(),void 0):"viewsourceDynamic"==e.type?(this._onViewSourceDynamic(e),void 0):("error"==e.type&&this._onFlashError(e),void 0)},fireOnLoad:function(e,t){svgweb._handleDone(e,t,this)},_handleScript:function(){this.document=new _Document(this._xml,this),this.document.documentElement=new _SVGSVGElement(this._xml.documentElement,this._svgString,this._scriptNode,this)},_handleObject:function(){this._svgObject=new _SVGObject(this._objNode,this),this._objNode=null},_onLog:function(e){console.log("FLASH: "+e.logString)},_onEvent:function(e){return"mouse"==e.eventType.substr(0,5)||"click"==e.eventType?(this._onMouseEvent(e),void 0):"key"==e.eventType.substr(0,3)?(this._onKeyboardEvent(e),void 0):"onRenderingFinished"==e.eventType?("script"==this.type?this.document.documentElement._onRenderingFinished(e):"object"==this.type&&this._svgObject._onRenderingFinished(e),void 0):"onFlashLoaded"==e.eventType?("script"==this.type?this.document.documentElement._onFlashLoaded(e):"object"==this.type&&this._svgObject._onFlashLoaded(e),void 0):void 0},_onMouseEvent:function(e){var t=this._getElementByGuid(e.targetGUID),n=this._getElementByGuid(e.currentTargetGUID),i={target:t._getProxyNode(),currentTarget:n._getProxyNode(),type:e.eventType,clientX:Math.round(new Number(e.stageX)),clientY:Math.round(new Number(e.stageY)),screenX:Math.round(new Number(e.stageX)),screenY:Math.round(new Number(e.stageY)),altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,button:0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){}},s=n._listeners[e.eventType];if(s)for(var r=0;r<s.length;r++){var a=s[r],o=a.listener;"object"==typeof o?o.handleEvent.call(o,i):o.call(i.currentTarget,i)}if(null!=e.scriptCode)if("object"==this.type){var l='var evt = { target: document.getElementById("'+t._getProxyNode().getAttribute("id")+'") ,\n'+'currentTarget:document.getElementById("'+n._getProxyNode().getAttribute("id")+'") ,\n'+'type: "'+e.eventType+'",\n'+"clientX: "+Math.round(new Number(e.stageX))+",\n"+"clientY: "+Math.round(new Number(e.stageY))+",\n"+"screenX: "+Math.round(new Number(e.stageX))+",\n"+"screenY: "+Math.round(new Number(e.stageY))+",\n"+"altKey: "+e.altKey+",\n"+"ctrlKey: "+e.ctrlKey+",\n"+"shiftKey: "+e.shiftKey+",\n"+"button: 0,\n"+"preventDefault: function() { this.returnValue=false; },\n"+"stopPropagation: function() { }\n"+"};\n",c=";(function (evt) { "+e.scriptCode+"; }"+").call(evt.currentTarget, evt);\n";this.sandbox_eval(this._svgObject._sandboxedScript(l+c))}else{var d=new Function(e.scriptCode);d.call(i.currentTarget,i)}},_onKeyboardEvent:function(e){var t=this._getElementByGuid(e.targetGUID),n=this._getElementByGuid(e.currentTargetGUID),i={target:t._getProxyNode(),currentTarget:n._getProxyNode(),type:e.eventType,keyCode:Number(e.keyCode),altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){}};if(!isFF&&!isChrome||"transparent"!=this.flash.getAttribute("wmode")){if("script"==this.type)for(var s=0;s<FlashHandler._keyboardListeners.length;s++){var r=FlashHandler._keyboardListeners[s];r.__type==i.type&&r.call(i.currentTarget,i)}for(var a=this._keyboardListeners,s=0;s<a.length;s++){var r=a[s];r.__type==i.type&&r.call(i.currentTarget,i)}}},addKeyboardListener:function(e,t,n){var i=function(e){return function(t){t.preventDefault||(t.preventDefault=function(){this.returnValue=!1,t=null}),"object"==typeof e?e.handleEvent.call(e,t):e(t)}}(t);i.__type=e,i.__listener=t,i.__useCapture=n,this._keyboardListeners.push(i)},_getElementByGuid:function(e){var t=svgweb._guidLookup["_"+e];if(t)return t;var n;"script"==this.type?n=xpath(this._xml,null,'//*[@__guid="'+e+'"]'):"object"==this.type&&(n=xpath(this._svgObject._xml,null,'//*[@__guid="'+e+'"]'));var i,t;return n.length?(i=n[0],t=FlashHandler._getNode(i,this),isIE&&t._fakeNode&&(t=t._fakeNode),t._attached=!0,t):null},_onFlashError:function(e){throw this._onLog(e),svgweb._fireFlashError("FLASH: "+e.logString),new Error("FLASH: "+e.logString)},_onObjectScript:function(e){this._svgObject._scriptsToExec.push(e.script)},_onViewSource:function(){var e=this._origSVG;e||(e="SVG Source Not Available"),e=e.replace(/>/g,"&gt;").replace(/</g,"&lt;");var t=window.open("","_blank");t.document.write("<html><body><pre>"+e+"</pre></body></html>"),t.document.close()},_onViewSourceDynamic:function(e){-1==e.source.indexOf("<?xml")&&(e.source='<?xml version="1.0"?>\n'+e.source),e.source=e.source.replace(/<svg:([^ ]+) /g,"<$1 "),e.source=e.source.replace(/<\/svg:([^>]+)>/g,"</$1>"),e.source=e.source.replace(/\n\s*<__text[^\/]*\/>/gm,""),e.source=e.source.replace(/<__text[^>]*>([^<]*)<\/__text>/gm,"$1"),e.source=e.source.replace(/<__text[^>]*>/g,""),e.source=e.source.replace(/<\/__text>/g,""),e.source=e.source.replace(/\s*__guid="[^"]*"/g,""),e.source=e.source.replace(/ id="__svg__random__[^"]*"/g,""),e.source=e.source.replace(/>\n\n/g,">\n"),e.source=e.source.replace(/>/g,"&gt;"),e.source=e.source.replace(/</g,"&lt;");var t=window.open("","_blank");t.document.write("<body><pre>"+e.source+"</pre></body>"),t.document.close()}}),NativeHandler._patchBrowserObjects=function(e,t){if(!t._getElementById){t._getElementById=t.getElementById,t.getElementById=function(e){var n=t._getElementById(e);if(null!==n)return null===n.parentNode?null:n;if(n=xpath(t,null,'//*[@id="'+e+'"]'),n.length){var i=n[0];return null!==i.namespaceURI&&i.namespaceURI!=svgns&&"http://www.w3.org/1999/xhtml"!=i.namespaceURI&&svgweb._exportID(i),i}return null},t._getElementsByTagNameNS=t.getElementsByTagNameNS,t.getElementsByTagNameNS=function(e,n){var i=t._getElementsByTagNameNS(e,n);if(null!==i&&0!==i.length){if(null!==e&&"http://www.w3.org/1999/xhtml"!=e&&e!=svgns){for(var s=0;s<i.length;s++){var r=i[s];svgweb._exportID(r)}return i}return i}(null===i||0===i.length)&&(i=createNodeList());for(var a,s=0;s<svgweb.handlers.length;s++){var o=svgweb.handlers[s];if("object"!=o.type){var l=o._namespaces["_"+e];if(l){var c;if(c="xmlns"==l?"//*[namespace-uri()='"+svgns+"' and name()='"+n+"']":l?"//"+l+":"+n:"//"+n,a=xpath(t,o._svgRoot,c,o._namespaces),null!==a&&void 0!==a&&a.length>0){for(var d=0;d<a.length;d++){var r=a[d];null!==r.namespaceURI&&r.namespaceURI!=svgns&&"http://www.w3.org/1999/xhtml"!=r.namespaceURI&&svgweb._exportID(r),i.push(r)}return i}}}}return createNodeList()},t._createElementNS=t.createElementNS,t.createElementNS=function(e,n){if(e!=svgns||"svg"!=n)return t._createElementNS(e,n);var i=t._createElementNS(e,n);return i=NativeHandler._patchAddEventListener(i)},t._createElement=t.createElement,t.createElement=function(e,n){if(!n)return t._createElement(e);if(n&&"object"==e){var i=t._createElement(e);return i=NativeHandler._patchAddEventListener(i)}throw"Unknown createElement() call for SVG: "+e},NativeHandler._patchCloneNode(),isFF&&NativeHandler._patchStyleObject(e);var n=t.rootElement;n&&"svg"==n.localName&&n.namespaceURI==svgns&&NativeHandler._patchSvgFileAddEventListener(e,t)}},NativeHandler._patchCloneNode=function(){var e;e="undefined"!=typeof SVGSVGElement?SVGSVGElement.prototype:document.createElementNS(svgns,"svg").__proto__,e._cloneNode||(e._cloneNode=e.cloneNode,e.cloneNode=function(e){var t=this._cloneNode(e);return NativeHandler._patchAddEventListener(t),t})},NativeHandler._patchAddEventListener=function(e){return"object"!=e.nodeName.toLowerCase()||NativeHandler._objectAddEventListener||(NativeHandler._objectAddEventListener=e.addEventListener),e._addEventListener="object"==e.nodeName.toLowerCase()?NativeHandler._objectAddEventListener:e.addEventListener,e._onloadListeners=[],e.addEventListener=function(){return function(t,n,i){"svgload"==t.toLowerCase()?this._onloadListeners.push(n):e._addEventListener(t,n,i)}}(),e},NativeHandler._patchStyleObject=function(e){for(var t=e.CSSStyleDeclaration,n=0;n<_Style._allStyles.length;n++){var i=_Style._allStyles[n],s=i.replace(/([A-Z])/g,"-$1").toLowerCase();!function(e,n){t.prototype.__defineSetter__(e,function(e){return this.setProperty(n,e,null)}),t.prototype.__defineGetter__(e,function(){return this.getPropertyValue(n)})}(i,s)}},NativeHandler._patchSvgFileAddEventListener=function(e){var t=e.addEventListener;e.addEventListener=function(e,n,i){"svgload"!=e.toLowerCase()?t(e,n,i):"object"==typeof n?n.handleEvent.call(n,void 0):n()},Object.defineProperty?Object.defineProperty(e,"onsvgload",{get:function(){return this.__onsvgload},set:function(e){this.__onsvgload=e,this.addEventListener("SVGLoad",e,!1)}}):(e.__defineGetter__("onsvgload",function(){return this.__onsvgload}),e.__defineSetter__("onsvgload",function(e){this.__onsvgload=e,this.addEventListener("SVGLoad",e,!1)}))},extend(NativeHandler,{start:function(){"object"==this.type?this._handleObject():"script"==this.type&&this._handleScript()},_handleScript:function(){this._namespaces=this._getNamespaces(),this._processSVGScript(this._xml,this._svgString,this._scriptNode),this._loaded=!0,svgweb._handleDone(this.id,"script",this)},_handleObject:function(){if(this._objNode.style.overflow="hidden",this._objNode.style.visibility="visible",this._objNode._svgWindow)this._onObjectLoad(this._objNode._svgFunc,this._objNode._svgWindow);else{this._objNode._svgHandler=this;var e=this,t=function(){if(e._objNode.contentDocument){var t=e._objNode.contentDocument.defaultView;e._onObjectLoad(e._objNode._svgFunc,t)}};if(this._objNode._addEventListener)this._objNode._addEventListener("load",t,!1);else if(isOpera&&null==this._objNode.onload){var n=this._objNode.parentNode,i=this._objNode.nextSibling;n.removeChild(this._objNode),this._objNode.addEventListener("load",t,!1),i?n.insertBefore(this._objNode,i):n.appendChild(this._objNode)}else this._objNode.addEventListener("load",t,!1)}},_onObjectLoad:function(e,t){if(this._loaded)return e&&e.apply(t),void 0;this._loaded=!0;var n=t.document;NativeHandler._patchBrowserObjects(t,n);var i=n.rootElement;i&&this._patchCurrentTranslate(i),t.svgns=svgns,t.xlinkns=xlinkns,this._namespaces=this._getNamespaces(n),e&&e.apply(t);for(var s=0;this._objNode._onloadListeners&&s<this._objNode._onloadListeners.length;s++)e=this._objNode._onloadListeners[s],e.apply(this._objNode);svgweb._fireOnLoad()},_processSVGScript:function(e,t,n){var e,i;try{i=document.importNode(e.documentElement,!0)}catch(s){"undefined"!=typeof DOMParser&&(e=(new DOMParser).parseFromString(t,"application/xml"),i=document.adoptNode(e.documentElement,!0))}n.parentNode.replaceChild(i,n),this._svgRoot=i,this._patchCurrentTranslate(this._svgRoot)},_getNamespaces:function(e){var t,n=[];t=e?e.documentElement.attributes:this._xml.documentElement.attributes;for(var i=0;i<t.length;i++){var s=t[i];if(/^xmlns:?(.*)$/.test(s.nodeName)){var r=s.nodeName.match(/^xmlns:?(.*)$/),a=r[1]?r[1]:"xmlns",o=s.nodeValue;n["_"+a]||(n["_"+a]=o,n["_"+o]=a,n.push(o))}}return n},_patchCurrentTranslate:function(e){var t;"undefined"!=typeof SVGRoot?t=e.currentTranslate:"undefined"!=typeof e.currentTranslate.__proto__?t=e.currentTranslate.__proto__:"undefined"!=typeof SVGPoint&&(t=SVGPoint.prototype),t.setX=function(e){return this.x=e},t.getX=function(){return this.x},t.setY=function(e){return this.y=e},t.getY=function(){return this.y},t.setXY=function(e,t){this.x=e,this.y=t}}}),extend(_RedrawManager,{isSuspended:function(){return this._ids.length>0},batch:function(e,t){this._batch.push(e+":"+t)},suspendRedraw:function(e,t){if(void 0===e)throw"Not enough arguments to suspendRedraw";void 0===t&&(t=!0);var n=this._nextID;this._nextID++;var i=this,s=window.setTimeout(function(){i.unsuspendRedraw(n),delete i._timeoutIDs["_"+n]},e);if(this._ids.push(n),this._timeoutIDs["_"+n]=s,t)try{"undefined"==typeof this._handler.flash.jsSuspendRedraw&&__flash__addCallback(this._handler.flash,"jsSuspendRedraw"),this._handler.flash.jsSuspendRedraw()}catch(r){console.log("suspendRedraw exception: "+r)}return n},unsuspendRedraw:function(e,t){void 0===t&&(t=!0);for(var n=-1,i=0;i<this._ids.length;i++)if(this._ids[i]==e){n=i;break}if(-1==n)throw"Unknown id passed to unsuspendRedraw: "+e;if(void 0!=this._timeoutIDs["_"+e]&&window.clearTimeout(this._timeoutIDs["_"+e]),this._ids.splice(n,1),delete this._timeoutIDs["_"+e],!this.isSuspended()&&(0!=this._batch.length||t)){var s=this._batch.join("__SVG__METHOD__DELIMIT");this._batch=[];try{"undefined"==typeof this._handler.flash.jsUnsuspendRedrawAll&&__flash__addCallback(this._handler.flash,"jsUnsuspendRedrawAll"),this._handler.flash.jsUnsuspendRedrawAll(s)}catch(r){console.log("unsuspendRedraw exception: "+r)}}},unsuspendRedrawAll:function(){for(var e=0;e<this._ids.length;e++)this.unsuspendRedraw(this._ids[e])},forceRedraw:function(){}}),extend(_DOMImplementation,{hasFeature:function(){}}),mixin(_Node,{ELEMENT_NODE:1,TEXT_NODE:3,DOCUMENT_NODE:9,DOCUMENT_FRAGMENT_NODE:11}),extend(_Node,{_listeners:null,_detachedListeners:null,insertBefore:function(e,t){if(this.nodeType!=_Node.ELEMENT_NODE&&this.nodeType!=_Node.DOCUMENT_FRAGMENT_NODE)throw"Not supported";e.parentNode&&e.parentNode.removeChild(e),e=this._getFakeNode(e),t=this._getFakeNode(t);var n,i=e.nodeType==_Node.DOCUMENT_FRAGMENT_NODE;if(i&&(n=e._getChildNodes(!0)),i&&0==n.length)return e._reset(),e._getProxyNode();var s=this._findChild(t);if(null===s)throw new Error("Invalid child passed to insertBefore");var r=s.position,a=[];if(i)for(var o=0;o<n.length;o++)a.push(n[o]);else a.push(e);for(var o=0;o<a.length;o++){var l=this._importNode(a[o],!1);this._nodeXML.insertBefore(l,t._nodeXML),this._processAppendedChildren(a[o],this,this._attached)}if(this._attached&&this._passThrough){var c=FlashHandler._encodeFlashData(xmlToStr(e,this._handler.document._namespaces));this._handler.sendToFlash("jsInsertBefore",[t._guid,this._guid,r,c])}if(!isIE)for(var o=0;o<a.length;o++)this._defineChildNodeAccessor(this._childNodes.length),this._childNodes.length++;return e.nodeType==_Node.DOCUMENT_FRAGMENT_NODE?e._reset():e._attached=this._attached,e._getProxyNode()},replaceChild:function(e,t){if(this.nodeType!=_Node.ELEMENT_NODE&&this.nodeType!=_Node.DOCUMENT_FRAGMENT_NODE)throw"Not supported";e.parentNode&&e.parentNode.removeChild(e),e=this._getFakeNode(e),t=this._getFakeNode(t);var n,i=e.nodeType==_Node.DOCUMENT_FRAGMENT_NODE;if(i&&(n=e._getChildNodes(!0)),i&&0==n.length)return e._reset(),e._getProxyNode();var s=this._findChild(t);if(null===s)throw new Error("Invalid child passed to replaceChild");var r=s.position;this.removeChild(t);var a=[];if(i)for(var o=0;o<n.length;o++)a.push(n[o]);else a.push(e);if(!isIE)for(var o=0;o<a.length;o++)this._defineChildNodeAccessor(this._childNodes.length),this._childNodes.length++;var l=!1;r>=this._nodeXML.childNodes.length&&(l=!0);for(var c=r,o=0;o<a.length;o++){var d=this._importNode(a[o],!1);if(l)this._nodeXML.appendChild(d);else{var u=this._nodeXML.childNodes[c];this._nodeXML.insertBefore(d,u),c++}}if(this._attached&&this._passThrough){var h=FlashHandler._encodeFlashData(xmlToStr(e,this._handler.document._namespaces));this._handler.sendToFlash("jsAddChildAt",[this._guid,r,h])}return this._processAppendedChildren(e,this,this._attached),t._setUnattached(),svgweb._removedNodes.push(t._getProxyNode()),e.nodeType==_Node.DOCUMENT_FRAGMENT_NODE?e._reset():e._attached=this._attached,t._getProxyNode()},removeChild:function(e){if(this.nodeType!=_Node.ELEMENT_NODE&&this.nodeType!=_Node.DOCUMENT_FRAGMENT_NODE)throw"Not supported";if(e.nodeType!=_Node.ELEMENT_NODE&&e.nodeType!=_Node.TEXT_NODE)throw"Not supported";e=this._getFakeNode(e);var t=this._findChild(e);if(null===t)throw new Error("Invalid child passed to removeChild");var n=t.position;if(this._nodeXML.removeChild(t.nodeXML),e.nodeType==_Node.ELEMENT_NODE){var i=e._getId();i&&this._attached&&(this._handler.document._nodeById["_"+i]=void 0)}return e._persistEventListeners(),isIE?this._childNodes.splice(n,1):(delete this._childNodes[this._childNodes.length-1],this._childNodes.length--),this._attached&&this._passThrough&&this._handler.sendToFlash("jsRemoveChild",[e._guid]),e._setUnattached(),svgweb._removedNodes.push(e._getProxyNode()),e._getProxyNode()},appendChild:function(e){if(this.nodeType!=_Node.ELEMENT_NODE&&this.nodeType!=_Node.DOCUMENT_FRAGMENT_NODE)throw"Not supported";e.parentNode&&e.parentNode.removeChild(e),e=this._getFakeNode(e);var t,n=e.nodeType==_Node.DOCUMENT_FRAGMENT_NODE;if(n&&(t=e._getChildNodes(!0)),n&&0==t.length)return e._reset(),e._getProxyNode();if(n)for(var i=0;i<t.length;i++)this._importNode(t[i]);else this._importNode(e);if(isIE)if(n)for(var i=0;i<t.length;i++)this._childNodes.push(t[i]._htcNode);else this._childNodes.push(e._htcNode);else if(n)for(var i=0;i<t.length;i++)this._defineChildNodeAccessor(this._childNodes.length),this._childNodes.length++;else this._defineChildNodeAccessor(this._childNodes.length),this._childNodes.length++;if(this._attached&&this._passThrough){var s=FlashHandler._encodeFlashData(xmlToStr(e,this._handler.document._namespaces));this._handler.sendToFlash("jsAppendChild",[this._guid,s])}return this._processAppendedChildren(e,this,this._attached),e.nodeType==_Node.DOCUMENT_FRAGMENT_NODE?e._reset():e._attached=this._attached,e._getProxyNode()},hasChildNodes:function(){return this._getChildNodes().length>0},isSupported:function(e,t){return"2.0"!=t?!1:"Core"==e?!0:"Events"==e||"UIEvents"==e||"MouseEvents"==e?!0:void 0},hasAttributes:function(){if(this.nodeType==_Node.ELEMENT_NODE){for(var e in this._attributes)if(!(/^_xmlns/i.test(e)||"_id"==e&&/^__svg__random__/.test(this._attributes[e])||"___guid"==e&&/^__guid/.test(this._attributes[e])||"___fakeTextNode"==e&&/^__fakeTextNode/.test(this._attributes[e])||!/^_.*/.test(e)||!this._attributes.hasOwnProperty(e)))return!0;return!1}return!1},addEventListener:function(e,t,n,i){if(this.nodeType!=_Node.ELEMENT_NODE&&this.nodeType!=_Node.TEXT_NODE&&(this.nodeType!=_Node.DOCUMENT_NODE||"key"!=e.substring(0,3)))throw"Not supported";return i||this._attached?(void 0===this._listeners[e]&&(this._listeners[e]=[]),this._listeners[e].push({type:e,listener:t,useCapture:n}),this._listeners[e]["_"+t.toString()+":"+n]=t,"key"==e.substring(0,3)?this._handler.addKeyboardListener(e,t,n):this._handler.sendToFlash("jsAddEventListener",[this._guid,e]),void 0):(this._detachedListeners.push({type:e,listener:t,useCapture:n}),void 0)},removeEventListener:function(e,t,n){if(this.nodeType!=_Node.ELEMENT_NODE&&this.nodeType!=_Node.TEXT_NODE)throw"Not supported";var i;return this._attached?(this._listeners[e]&&(i=this._findListener(this._listeners[e],e,t,n),null!==i&&(this._listeners[e].splice(i,1),delete this._listeners[e]["_"+t.toString()+":"+n])),"key"==e.substring(0,3)&&(i=this._findListener(this._keyboardListeners,e,t,n),null!==i&&this._keyboardListeners.splice(i,1)),this._handler.sendToFlash("jsRemoveEventListener",[this._guid,e]),void 0):(i=this._findListener(this._detachedListeners,e,t,n),null!==i&&this._detachedListeners.splice(i,1),void 0)},getScreenCTM:function(){if(this._handler){var e=this._handler.sendToFlash("jsGetScreenCTM",[this._guid]);return e=this._handler._stringToMsg(e),new _SVGMatrix(new Number(e.a),new Number(e.b),new Number(e.c),new Number(e.d),new Number(e.e),new Number(e.f),this._handler)}return new _SVGMatrix(1,0,0,1,0,0)},getCTM:function(){return this.getScreenCTM()},cloneNode:function(e){var t;if(this.nodeType==_Node.ELEMENT_NODE&&this.namespaceURI!=svgns)t=new _Element(this.nodeName,this.prefix,this.namespaceURI);else if(this.nodeType==_Node.ELEMENT_NODE)t=document.createElementNS(this.namespaceURI,this.nodeName);else if(this.nodeType==_Node.TEXT_NODE)t=document.createTextNode(this._nodeValue,!0);else{if(this.nodeType!=_Node.DOCUMENT_FRAGMENT_NODE)throw"cloneNode not supported for nodeType: "+this.nodeType;t=document.createDocumentFragment(!0)}t=this._getFakeNode(t);for(var n=this._nodeXML.attributes,i=0;i<n.length;i++){var s=n.item(i);s.name.match(/([^:]+):?(.*)/);var r=s.namespaceURI;if(isSafari&&-1!=s.name.indexOf("xmlns"))t._nodeXML.setAttribute(s.name,s.nodeValue);else{var a,o=t._nodeXML.ownerDocument;a=isIE?o.createNode(2,s.name,r):o.createAttributeNS(r,s.name),a.nodeValue=s.nodeValue,isIE?t._nodeXML.setAttributeNode(a):t._nodeXML.setAttributeNodeNS(a)}}if(t._nodeXML.setAttribute("__guid",t._guid),isIE)for(var l=this._htcNode.style,i=0;i<l.length;i++){var c=l.item(i),d=l.getPropertyValue(c);try{t._htcNode.style.length++}catch(u){}t.style.length++,t.style._ignoreStyleChanges=!0,t._htcNode.style[c]=d,t.style._ignoreStyleChanges=!1}if(t.nodeType==_Node.ELEMENT_NODE&&t._importAttributes(t,t._nodeXML),e&&(t.nodeType==_Node.ELEMENT_NODE||t.nodeType==_Node.DOCUMENT_FRAGMENT_NODE))for(var h=this._getChildNodes(),i=0;i<h.length;i++){var f=h[i].cloneNode(!0);t.appendChild(f)}return t.ownerDocument=this.ownerDocument,t._getProxyNode()},toString:function(){return this.namespaceURI==svgns?"[_SVG"+this.localName.charAt(0).toUpperCase()+this.localName.substring(1)+"]":this.prefix?"["+this.prefix+":"+this.localName+"]":this.localName?"["+this.localName+"]":"["+this.nodeName+"]"},_addEvent:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&(e["e"+t+n]=n,e[t+n]=function(e,t,n){return function(){e["e"+t+n](window.event)}}(e,t,n),e.attachEvent("on"+t,e[t+n]))},nodeName:null,nodeType:null,ownerDocument:null,namespaceURI:null,localName:null,prefix:null,_getParentNode:function(){if(this.nodeType==_Node.DOCUMENT_NODE||this.nodeType==_Node.DOCUMENT_FRAGMENT_NODE)return null;if(this._attached&&this._handler&&this._getProxyNode()==this._handler.document.rootElement){if("script"==this._handler.type)return this._handler.flash.parentNode;if("object"==this._handler.type)return this._handler.document}var e=this._nodeXML.parentNode;if(null===e||e.nodeType==_Node.DOCUMENT_NODE)return null;var t=FlashHandler._getNode(e,this._handler);return this._getFakeNode(t)._attached=this._attached,t},_getFirstChild:function(){if(this.nodeType==_Node.TEXT_NODE)return null;var e=this._nodeXML.firstChild;if(null===e)return null;var t=FlashHandler._getNode(e,this._handler);return this._getFakeNode(t)._attached=this._attached,t},_getLastChild:function(){if(this.nodeType==_Node.TEXT_NODE)return null;var e=this._nodeXML.lastChild;if(null===e)return null;var t=FlashHandler._getNode(e,this._handler);return this._getFakeNode(t)._attached=this._attached,t},_getPreviousSibling:function(){if(this.nodeType==_Node.DOCUMENT_NODE||this.nodeType==_Node.DOCUMENT_FRAGMENT_NODE)return null;if(this._attached&&this._handler&&this._getProxyNode()==this._handler.document.rootElement&&"script"==this._handler.type){var e=this._handler.flash.previousSibling;if(e&&1==e.nodeType&&e.className&&-1!=e.className.indexOf("embedssvg")){var t=e.getAttribute("id").replace("_flash",""),n=svgweb.handlers[t].document.documentElement;return n._getProxyNode()}return e}var i=this._nodeXML.previousSibling;if(null===i||7==i.nodeType)return null;var n=FlashHandler._getNode(i,this._handler);return this._getFakeNode(n)._attached=this._attached,n},_getNextSibling:function(){if(this.nodeType==_Node.DOCUMENT_NODE||this.nodeType==_Node.DOCUMENT_FRAGMENT_NODE)return null;if(this._attached&&this._handler&&this._getProxyNode()==this._handler.document.rootElement&&"script"==this._handler.type){var e=this._handler.flash.nextSibling;if(e&&1==e.nodeType&&e.className&&-1!=e.className.indexOf("embedssvg")){var t=e.getAttribute("id").replace("_flash",""),n=this._handler.document._nodeById["_"+t];return n._getProxyNode()}return e}var i=this._nodeXML.nextSibling;if(null===i)return null;var n=FlashHandler._getNode(i,this._handler);return this._getFakeNode(n)._attached=this._attached,n},_passThrough:!0,_attached:!1,_fake:!0,_defineNodeAccessors:function(){if(this.__defineGetter__("parentNode",hitch(this,this._getParentNode)),this.__defineGetter__("firstChild",hitch(this,this._getFirstChild)),this.__defineGetter__("lastChild",hitch(this,this._getLastChild)),this.__defineGetter__("previousSibling",hitch(this,this._getPreviousSibling)),this.__defineGetter__("nextSibling",hitch(this,this._getNextSibling)),this.__defineGetter__("childNodes",function(e){return function(){return e._childNodes}}(this)),"#text"==this.nodeName)this._childNodes.length=0;else{var e=this._nodeXML.childNodes;this._childNodes.length=e.length;for(var t=0;t<e.length;t++)this._defineChildNodeAccessor(t)}this.nodeType==_Node.TEXT_NODE?(this.__defineGetter__("data",function(e){return function(){return e._nodeValue}}(this)),this.__defineSetter__("data",function(e){return function(t){return e._setNodeValue(t)}}(this)),this.__defineGetter__("textContent",function(e){return function(){return e._nodeValue}}(this)),this.__defineSetter__("textContent",function(e){return function(t){return e._setNodeValue(t)}}(this))):this.__defineGetter__("textContent",function(){return function(){return""}}()),this.__defineGetter__("nodeValue",function(e){return function(){return e._nodeValue}}(this)),this.__defineSetter__("nodeValue",function(e){return function(t){return e._setNodeValue(t)}}(this))},_defineChildNodeAccessor:function(e){var t=this;this._childNodes.__defineGetter__(e,function(){var n=t._nodeXML.childNodes[e],i=FlashHandler._getNode(n,t._handler);return i._attached=t._attached,i})},_getChildNodes:function(e){if(!isIE)return this._childNodes;void 0===e&&(e=!1);var t=createNodeList();if("#text"==this.nodeName)return t;if(this._nodeXML.childNodes.length!=this._childNodes.length||e){for(var n=0;n<this._nodeXML.childNodes.length;n++){var i=this._nodeXML.childNodes[n],s=FlashHandler._getNode(i,this._handler);s._fakeNode._attached=this._attached,e&&(s=s._fakeNode),t.push(s)}return this._childNodes=t,t}return this._childNodes},_createHTC:function(){if(Object.defineProperty)this._htcNode=document.createElement("div"),this._htcNode.appendChild=function(e){return this._fakeNode.appendChild(e)},this._htcNode.addEventListener=function(e,t,n){return this._fakeNode.addEventListener(e,t,n)},this._htcNode.beginElement=function(){return this._fakeNode.beginElement()},this._htcNode.beginElementAt=function(e){return this._fakeNode.beginElementAt(e)},this._htcNode.endElement=function(){return this._fakeNode.endElement()},this._htcNode.endElementAt=function(e){return this._fakeNode.endElementAt(e)},this._htcNode._cloneNode=this._htcNode.cloneNode,this._htcNode.cloneNode=function(e){return this._fakeNode.cloneNode(e)},this._htcNode.createSVGPoint=function(){return this._fakeNode.createSVGPoint()},this._htcNode.createSVGRect=function(){return this._fakeNode.createSVGRect()},this._htcNode.getAttribute=function(e){return this._fakeNode.getAttribute(e)},this._htcNode.getAttributeNS=function(e,t){return this._fakeNode.getAttributeNS(e,t)},this._htcNode.getScreenCTM=function(){return this._fakeNode.getScreenCTM()},this._htcNode.getBBox=function(){return this._fakeNode.getBBox()},this._htcNode.getCTM=function(){return this._fakeNode.getCTM()},this._htcNode.getElementsByTagNameNS=function(e,t){return this._fakeNode.getElementsByTagNameNS(e,t)},this._htcNode.hasChildNodes=function(){return this._fakeNode.hasChildNodes()},this._htcNode.hasAttributes=function(){return this._fakeNode.hasAttributes()},this._htcNode.hasAttribute=function(e){return this._fakeNode.hasAttribute(e)},this._htcNode.hasAttributeNS=function(e,t){return this._fakeNode.hasAttributeNS(e,t)},this._htcNode.insertBefore=function(e,t){return this._fakeNode.insertBefore(e,t)},this._htcNode.isSupported=function(e,t){return this._fakeNode.isSupported(e,t)},this._htcNode.setAttribute=function(e,t){return this._fakeNode.setAttribute(e,t)
},this._htcNode.setAttributeNS=function(e,t,n){return this._fakeNode.setAttributeNS(e,t,n)},this._htcNode.removeChild=function(e){return this._fakeNode.removeChild(e)},this._htcNode.replaceChild=function(e,t){return this._fakeNode.replaceChild(e,t)},this._htcNode.removeAttribute=function(e){return this._fakeNode.removeAttribute(e)},this._htcNode.removeAttributeNS=function(e,t){return this._fakeNode.removeAttributeNS(e,t)},this._htcNode.removeEventListener=function(e,t,n){return this._fakeNode.removeEventListener(e,t,n)},this._htcNode.get=function(e){return this._fakeNode.get(e)},this._htcNode.set=function(e,t){return this._fakeNode.set(e,t)},this._htcNode.create=function(e,t,n,i,s){return this._fakeNode.create(e,t,n,i,s)},this._htcNode.createChild=function(e,t,n,i,s){return this._fakeNode.createChild(e,t,n,i,s)},this._htcNode.addChild=function(e,t){return this._fakeNode.addChild(e,t)},this._htcNode._getNodeName=function(){return this._fakeNode.nodeName},this._htcNode._getNodeType=function(){return this._fakeNode.nodeType},this._htcNode._getLocalName=function(){return this._fakeNode.localName},this._htcNode._getPrefix=function(){return this._fakeNode.prefix},this._htcNode._getNamespaceURI=function(){return this._fakeNode.namespaceURI},this._htcNode._getChildNodes=function(){return this._fakeNode._getChildNodes()},this._htcNode._getParentNode=function(){return this._fakeNode._getParentNode()},this._htcNode._getFirstChild=function(){return this._fakeNode._getFirstChild()},this._htcNode._getLastChild=function(){return this._fakeNode._getLastChild()},this._htcNode._getPreviousSibling=function(){return this._fakeNode._getPreviousSibling()},this._htcNode._getNextSibling=function(){return this._fakeNode._getNextSibling()},this._htcNode._getNodeValue=function(){return this._fakeNode._nodeValue},this._htcNode._setNodeValue=function(e){return this._fakeNode._setNodeValue(e)},this._htcNode._getTextContent=function(){return this._fakeNode._getTextContent()},this._htcNode._setTextContent=function(e){return this._fakeNode._setTextContent(e)},this._htcNode._getData=function(){return this._fakeNode._getData()},this._htcNode._setData=function(e){return this._fakeNode._setData(e)},this._htcNode._getOwnerDocument=function(){return this._fakeNode.ownerDocument},this._htcNode._getId=function(){return this._fakeNode._getId()},this._htcNode._setId=function(e){return this._fakeNode._setId(e)},this._htcNode._getX=function(){return this._fakeNode._getX()},this._htcNode._getY=function(){return this._fakeNode._getY()},this._htcNode._getWidth=function(){return this._fakeNode._getWidth()},this._htcNode._getHeight=function(){return this._fakeNode._getHeight()},this._htcNode._getCurrentScale=function(){return this._fakeNode._getCurrentScale()},this._htcNode._setCurrentScale=function(e){return this._fakeNode._setCurrentScale(e)},this._htcNode._getCurrentTranslate=function(){return this._fakeNode._getCurrentTranslate()},Object.defineProperty(this._htcNode,"currentScale",{get:function(){return this._getCurrentScale()},set:function(e){this._setCurrentScale(e)}}),Object.defineProperty(this._htcNode,"currentTranslate",{get:function(){return this._getCurrentTranslate()},set:function(){}}),Object.defineProperty(this._htcNode,"nodeName",{get:function(){return this._getNodeName()},set:function(){}}),Object.defineProperty(this._htcNode,"nodeType",{get:function(){return this._getNodeType()},set:function(){}}),Object.defineProperty(this._htcNode,"localName",{get:function(){return this._getLocalName()},set:function(){}}),Object.defineProperty(this._htcNode,"prefix",{get:function(){return this._getPrefix()},set:function(){}}),Object.defineProperty(this._htcNode,"namespaceURI",{get:function(){return this._getNamespaceURI()},set:function(){}}),Object.defineProperty(this._htcNode,"childNodes",{get:function(){return this._getChildNodes()},set:function(){}}),Object.defineProperty(this._htcNode,"parentNode",{get:function(){return this._getParentNode()},set:function(){}}),Object.defineProperty(this._htcNode,"firstChild",{get:function(){return this._getFirstChild()},set:function(){}}),Object.defineProperty(this._htcNode,"id",{get:function(){return this._getId()},set:function(e){this._setId(e)}}),Object.defineProperty(this._htcNode,"lastChild",{get:function(){return this._getLastChild()},set:function(){}}),Object.defineProperty(this._htcNode,"previousSibling",{get:function(){return this._getPreviousSibling()},set:function(){}}),Object.defineProperty(this._htcNode,"nextSibling",{get:function(){return this._getNextSibling()},set:function(){}}),Object.defineProperty(this._htcNode,"nodeValue",{get:function(){return this._getNodeValue()},set:function(e){this._setNodeValue(e)}}),Object.defineProperty(this._htcNode,"textContent",{get:function(){return this._getTextContent()},set:function(e){this._setTextContent(e)}}),Object.defineProperty(this._htcNode,"data",{get:function(){return this._getData()},set:function(e){this._setData(e)}}),Object.defineProperty(this._htcNode,"ownerDocument",{get:function(){return this._getOwnerDocument()},set:function(){}}),Object.defineProperty(this._htcNode,"x",{get:function(){return this._getX()},set:function(){}}),Object.defineProperty(this._htcNode,"y",{get:function(){return this._getY()},set:function(){}}),Object.defineProperty(this._htcNode,"width",{get:function(){return this._getWidth()},set:function(){}}),Object.defineProperty(this._htcNode,"height",{get:function(){return this._getHeight()},set:function(){}}),this._htcNode._fakeNode=this,this._htcNode._handler=this._handler;else{if(!this._htcContainer&&(this._htcContainer=document.getElementById("__htc_container"),!this._htcContainer)){var e=document.getElementsByTagName("body")[0],t=document.createElement("div");t.id="__htc_container",t.style.position="absolute",t.style.top="-5000px",t.style.left="-5000px",e.appendChild(t),this._htcContainer=t}this._htcNode=document.createElement("svg:"+this.nodeName),this._htcNode._fakeNode=this,this._htcNode._handler=this._handler,this._htcContainer.appendChild(this._htcNode)}},_setNodeValue:function(e){if(this.nodeType!=_Node.TEXT_NODE)return e;if(this._nodeValue=e,this._nodeXML.firstChild.nodeValue=e,this._attached&&this._passThrough){var t=FlashHandler._encodeFlashData(e),n=this._nodeXML.parentNode.getAttribute("__guid");this._handler.sendToFlash("jsSetText",[n,this._guid,t])}return e},_getFakeNode:function(e){return e||(e=this),isIE&&e._fakeNode&&(e=e._fakeNode),e},_processAppendedChildren:function(e,t,n){var i,s;for(i=e.nodeType==_Node.DOCUMENT_FRAGMENT_NODE?this._getFakeNode(e._getFirstChild()):e,n&&(s=this._handler._redrawManager.suspendRedraw(1e4,!1));i;){var r=i._nodeXML;i._handler=this._handler;var a=r.getAttribute("id");if(n&&i.nodeType==_Node.ELEMENT_NODE&&a&&(this._handler.document._nodeById["_"+a]=i),n){"script"==this._handler.type?i.ownerDocument=document:"object"==this._handler.type&&(i.ownerDocument=this._handler.document),i._attached=!0;for(var o=0;o<i._detachedListeners.length;o++){var l=i._detachedListeners[o];l&&i.addEventListener(l.type,l.listener,l.useCapture,!0)}i._detachedListeners=[]}var c=i._getChildNodes(),d=c&&c.length>0?c[0]:null;for(d&&(i=d,isIE&&(i=i._fakeNode));!d&&i;){if(i!=e&&(d=i._getNextSibling())){i=d,isIE&&(i=i._fakeNode);break}i==e?i=null:(i=i._getParentNode(),i&&isIE&&(i=i._fakeNode),i&&(1!=i.nodeType||i._handler&&i._getProxyNode()==i._handler.document.rootElement)&&(i=null))}}n&&this._handler._redrawManager.unsuspendRedraw(s,!1)},_importNode:function(e,t){"undefined"==typeof t&&(t=!0);var n;n=this._attached?this._handler.document._xml:this._nodeXML.ownerDocument;var i;return i="undefined"==typeof n.importNode?document._importNodeFunc(n,e._nodeXML,!0):n.importNode(e._nodeXML,!0),t&&this._nodeXML.appendChild(i),e._importChildXML(i),i},_importChildXML:function(e){this._nodeXML=e;for(var t=this._getChildNodes(),n=0;n<t.length;n++){var i=t[n];isIE&&i._fakeNode&&(i=i._fakeNode),i._nodeXML=this._nodeXML.childNodes[n],i._importChildXML(this._nodeXML.childNodes[n])}},_findChild:function(e,t){void 0===t&&(t=!1);for(var n={},i=0,s=0;s<this._nodeXML.childNodes.length;s++){var r=this._nodeXML.childNodes[s];if(!(r.nodeType!=_Node.ELEMENT_NODE&&r.nodeType!=_Node.TEXT_NODE||t&&(r.getAttribute("__fakeTextNode")||r.nodeType==_Node.TEXT_NODE)||(r.nodeType==_Node.ELEMENT_NODE&&i++,r.nodeType!=_Node.ELEMENT_NODE||r.getAttribute("__guid")!=e._guid)))return n.position=t?i:s,n.nodeXML=r,n}return null},_setUnattached:function(){for(var e=this._getChildNodes(),t=0;t<e.length;t++){var n=e[t];isIE&&(n=n._fakeNode),n._setUnattached()}this._attached=!1,this._handler=null},_getProxyNode:function(){return isIE?this._htcNode:this},_createChildNodes:function(){var e;return isIE?e=createNodeList():(e={},e.item=function(e){return e>=this.length?null:this[e]}),e},_getTextContent:function(){return this.nodeType==_Node.TEXT_NODE?this._nodeValue:""},_setTextContent:function(e){return this.nodeType==_Node.TEXT_NODE?this._setNodeValue(e):""},_getData:function(){return this.nodeType==_Node.TEXT_NODE?this._nodeValue:void 0},_setData:function(e){return this.nodeType==_Node.TEXT_NODE?this._setNodeValue(e):void 0},_createEmptyMethods:function(){this.nodeType==_Node.TEXT_NODE&&(this.getAttribute=this.getAttributeNS=this.setAttribute=this.setAttributeNS=this.removeAttribute=this.removeAttributeNS=this.hasAttribute=this.hasAttributeNS=this.getElementsByTagNameNS=this._getId=this._setId=this._getX=this._getY=this._getWidth=this._getHeight=this._getCurrentScale=this._setCurrentScale=this._getCurrentTranslate=this.createSVGRect=this.createSVGPoint=function(){return void 0})},_persistEventListeners:function(){for(var e in this._listeners)for(var t=0;t<this._listeners[e].length;t++){var n=this._listeners[e][t];this._detachedListeners.push({type:n.type,listener:n.listener,useCapture:n.useCapture})}this._listeners=[];for(var i=this._getChildNodes(),t=0;t<i.length;t++){var s=i[t];s._fakeNode&&(s=s._fakeNode),s._persistEventListeners()}},_findListener:function(e,t,n,i){for(var s=0;s<e.length;s++){var r=e[s];if(r.listener==n&&r.type==t&&r.useCapture==i)return s}return null}}),_Element.prototype=new _Node,extend(_Element,{getAttribute:function(e){return this.getAttributeNS(null,e,!0)},getAttributeNS:function(e,t,n){var i;if(null==e&&"__guid"==t)return null;if(this._attached&&this._passThrough&&!this._handler._redrawManager.isSuspended())i=this._handler.sendToFlash("jsGetAttribute",[this._guid,!1,!1,e,t,!0]);else if(isIE){if(isIE)if(e)for(var s=0;s<this._nodeXML.attributes.length;s++){var r=this._nodeXML.attributes.item(s),a=new String(r.name).match(/[^:]*:?(.*)/)[1];if(r.namespaceURI&&r.namespaceURI==e&&a==t){i=r.nodeValue;break}}else i=this._nodeXML.getAttribute(t)}else i=this._nodeXML.getAttributeNS(e,t);return"null"!=e||"id"!=t||i?void 0===i||null===i||/^[ ]*$/.test(i)?n?null:"":i:""},removeAttribute:function(e){this.removeAttributeNS(null,e)},removeAttributeNS:function(e,t){if("id"==t&&this._attached&&this.namespaceURI==svgns){var n=this._handler.document,i=this._nodeXML.getAttribute("id");n._nodeById["_"+i]=void 0}var s;if(e)for(var r=0;r<this._nodeXML.attributes.length;r++){var a,o,l=this._nodeXML.attributes.item(r),c=new String(l.name).match(/([^:]+:)?(.*)/);if(-1!=l.name.indexOf(":")?(a=c[1],o=c[2]):o=c[1],l.namespaceURI&&l.namespaceURI==e&&o==t){s=l;break}}else s=this._nodeXML.getAttributeNode(t);if(!s)return console.log("No attribute node found for: "+t+" in the namespace: "+e),void 0;this._nodeXML.removeAttributeNode(s);var d=t;e&&(d=a+":"+t),this._attributes["_"+d]=void 0,this._attached&&this._passThrough&&this._handler.sendToFlash("jsRemoveAttribute",[this._guid,e,t])},setAttribute:function(e,t){this.setAttributeNS(null,e,t)},setAttributeNS:function(e,t,n){(null===n||"undefined"==typeof n)&&(n="");var i=t;if(-1!=t.indexOf(":")&&(i=t.split(":")[1]),this._attached&&"id"==t){var s=this._handler.document,r=this._nodeXML.getAttribute("id");s._nodeById["_"+r]=void 0,(0===r||r)&&(s._nodeById["_"+n]=this)}if(isSafari&&"style"==i&&null!==this._nodeXML.parentNode&&"clipPath"==this._nodeXML.parentNode.nodeName){var a=this._nodeXML.nextSibling,o=this._nodeXML.parentNode;this._nodeXML.parentNode.removeChild(this._nodeXML),this._nodeXML.setAttribute("style",n),a?o.insertBefore(this._nodeXML,a):o.appendChild(this._nodeXML)}else if(e&&isIE){var l=this._nodeXML.ownerDocument.createNode(2,t,e);l.nodeValue=n,this._nodeXML.setAttributeNode(l)}else isIE?this._nodeXML.setAttribute(t,n):this._nodeXML.setAttributeNS(e,t,n);if(/^xmlns:?(.*)$/.test(t)){var c=t.match(/^xmlns:?(.*)$/),d=c[1]?c[1]:"xmlns",u=n;svgweb._allSVGNamespaces["_"+d]||(svgweb._allSVGNamespaces["_"+d]=u,svgweb._allSVGNamespaces["_"+u]=d)}if(this._attributes["_"+t]=n,this._attached&&this._passThrough){var h=FlashHandler._encodeFlashData(n);this._handler.sendToFlash("jsSetAttribute",[this._guid,!1,e,i,h])}this._handler&&"script"==this._handler.type&&this._attached&&this._getProxyNode()==this._handler.document.rootElement&&("width"==i||"height"==i)&&svgweb._onWindowResize()},hasAttribute:function(e){return this.hasAttributeNS(null,e)},hasAttributeNS:function(e,t){if(e||isIE){if(isIE){for(var n=null,i=0;i<this._nodeXML.attributes.length;i++){var s=this._nodeXML.attributes.item(i),r=new String(s.name).match(/(?:[^:]+:)?(.*)/),a=r[1],o=s.namespaceURI;if(""==o&&(o=null),e==o&&a==t){n=s;break}}return null!=n}return this._nodeXML.hasAttributeNS(e,t)}return this._nodeXML.hasAttribute(t)},getElementsByTagNameNS:function(e,t){var n,i=createNodeList();if(""==e&&(e=null),e==svgns&&(e=svgnsFake),this._nodeXML.getElementsByTagNameNS)i=this._nodeXML.getElementsByTagNameNS(e,t);else{var s=null;this._attached&&(s=this._handler.document._namespaces);var r="xmlns";if(e&&"*"!=e&&s&&(r=s["_"+e],void 0===r))return createNodeList();var a;if(a="*"==e&&"*"==t?"//*[ancestor::*[@__guid = '"+this._guid+"']]":"*"==e?"//*[namespace-uri()='*' and local-name()='"+t+"'"+" and ancestor::*[@__guid = '"+this._guid+"']]":"*"==t?"//*[namespace-uri()='"+e+"'"+" and ancestor::*[@__guid = '"+this._guid+"']]":"//"+t+"[ancestor::*[@__guid = '"+this._guid+"']]"+"| //*[namespace-uri()='"+e+"' and local-name()='"+t+"'"+" and ancestor::*[@__guid = '"+this._guid+"']]",n=xpath(this._nodeXML.ownerDocument,this._nodeXML,a,s),null!==n&&void 0!==n&&n.length>0)for(var o=0;o<n.length;o++)n[o]!==this._nodeXML&&i.push(n[o])}if(("*"==e||e==svgnsFake)&&"*"==t){for(var l=[],o=0;o<i.length;o++)i[o].nodeType==_Node.ELEMENT_NODE&&"__text"!=i[o].nodeName&&l.push(i[o]);i=l}for(var c=createNodeList(),o=0;o<i.length;o++){var d=FlashHandler._getNode(i[o],this._handler);this._getFakeNode(d)._attached=this._attached,c.push(d)}return c},beginElement:function(){this.beginElementAt(0)},endElement:function(){this.endElementAt(0)},beginElementAt:function(e){this._attached&&this._passThrough&&this._handler.sendToFlash("jsBeginElementAt",[this._guid,e])},endElementAt:function(e){this._attached&&this._passThrough&&this._handler.sendToFlash("jsEndElementAt",[this._guid,e])},style:null,_setClassName:function(){},_getClassName:function(){},_setTransform:function(){},_getTransform:function(){},_getViewBox:function(){},_getId:function(){return this._attributes._id?this._attributes._id:""},_setId:function(e){return this.setAttribute("id",e)},ownerSVGElement:null,_getX:function(){var e=this._trimMeasurement(this.getAttribute("x"));return new _SVGAnimatedLength(new _SVGLength(new Number(e)))},_getY:function(){var e=this._trimMeasurement(this.getAttribute("y"));return new _SVGAnimatedLength(new _SVGLength(new Number(e)))},_getWidth:function(){var e=this._trimMeasurement(this.getAttribute("width"));return new _SVGAnimatedLength(new _SVGLength(new Number(e)))},_getHeight:function(){var e=this._trimMeasurement(this.getAttribute("height"));return new _SVGAnimatedLength(new _SVGLength(new Number(e)))},_getCurrentScale:function(){return this._currentScale},_setCurrentScale:function(e){return e!==this._currentScale&&(this._currentScale=e,this._handler.sendToFlash("jsSetCurrentScale",[e])),e},_getCurrentTranslate:function(){return this._currentTranslate},createSVGPoint:function(){return new _SVGPoint(0,0)},createSVGRect:function(){return new _SVGRect(0,0,0,0)},getBBox:function(){if(this._handler){var e=this._handler.sendToFlash("jsGetBBox",[this._guid]);return e=this._handler._stringToMsg(e),new _SVGRect(new Number(e.x),new Number(e.y),new Number(e.width),new Number(e.height))}return new _SVGRect(0,0,0,0)},_trimMeasurement:function(e){return null!==e&&(e=e.replace(/[a-z]/gi,"")),e},_getInnerHTML:function(){},_setInnerHTML:function(){},_allEvents:["onfocusin","onfocusout","onactivate","onclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onload","onunload","onabort","onerror","onresize","onscroll","onzoom","onbegin","onend","onrepeat"],_handleEvent:function(){},_prepareEvents:function(){},_attributes:null,_importAttributes:function(e,t){for(var n=0;n<t.attributes.length;n++){var i=t.attributes[n];this._attributes["_"+i.nodeName]=i.nodeValue}},_defineAccessors:function(){var e=this;("svg"==this.nodeName||"use"==this.nodeName)&&(this.__defineGetter__("x",function(){return e._getX()}),this.__defineGetter__("y",function(){return e._getY()}),this.__defineGetter__("width",function(){return e._getWidth()}),this.__defineGetter__("height",function(){return e._getHeight()})),"svg"==this.nodeName&&(this.__defineGetter__("currentTranslate",function(){return e._getCurrentTranslate()}),this.__defineGetter__("currentScale",function(){return e._getCurrentScale()}),this.__defineSetter__("currentScale",function(t){return e._setCurrentScale(t)})),this.__defineGetter__("id",hitch(this,this._getId)),this.__defineSetter__("id",hitch(this,this._setId))},_defineAccessor:function(e,t){var n=this,i=function(){return n.getAttribute(e)};if(this.__defineGetter__(e,i),t){var s=function(t){return n.setAttribute(e,t)};this.__defineSetter__(e,s)}}}),_DocumentFragment.prototype=new _Node,extend(_DocumentFragment,{_reset:function(){for(;this._nodeXML.firstChild;)this._nodeXML.removeChild(this._nodeXML.firstChild);this._childNodes=this._createChildNodes(),isIE||this._defineNodeAccessors()}}),_Style._allStyles=["font","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","direction","letterSpacing","textDecoration","unicodeBidi","wordSpacing","clip","color","cursor","display","overflow","visibility","clipPath","clipRule","mask","opacity","enableBackground","filter","floodColor","floodOpacity","lightingColor","stopColor","stopOpacity","pointerEvents","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","fill","fillOpacity","fillRule","imageRendering","marker","markerEnd","markerMid","markerStart","shapeRendering","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","textRendering","alignmentBaseline","baselineShift","dominantBaseline","glyphOrientationHorizontal","glyphOrientationVertical","kerning","textAnchor","writingMode"],_Style._allRootStyles=["border","verticalAlign","backgroundColor","top","right","bottom","left","position","width","height","margin","marginTop","marginBottom","marginRight","marginLeft","padding","paddingTop","paddingBottom","paddingLeft","paddingRight","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","zIndex","overflowX","overflowY","float","clear"],extend(_Style,{_ignoreStyleChanges:!0,_setup:function(){if(this._normalizeStyle(),isIE){for(var e=this._element._htcNode.style,t=this._fromStyleString(),n=0;n<t.length;n++){var i=this._toCamelCase(t[n].styleName),s=t[n].styleValue;try{e[i]=s}catch(r){console.log("The following exception occurred setting style."+i+" on IE: "+(r.message||r))}}try{e.length=0}catch(r){}if(this.length=0,e.item=hitch(this,this.item),e.setProperty=hitch(this,this.setProperty),e.getPropertyValue=hitch(this,this.getPropertyValue),this._changeListener=hitch(this,this._onPropertyChange),this._element._htcNode.attachEvent("onpropertychange",this._changeListener),isIE&&isIE>=8)return e.pixelBottom}else{for(var n=0;n<_Style._allStyles.length;n++){var i=_Style._allStyles[n];this._defineAccessor(i)}if(this._element._handler&&this._element._getProxyNode()==this._element._handler.document.rootElement)for(var n=0;n<_Style._allRootStyles.length;n++){var i=_Style._allRootStyles[n];this._defineAccessor(i)}this.__defineGetter__("length",hitch(this,this._getLength))}},_defineAccessor:function(e){var t=this;this.__defineGetter__(e,function(){return t._getStyleAttribute(e)}),this.__defineSetter__(e,function(n){return t._setStyleAttribute(e,n)})},_setStyleAttribute:function(e,t){for(var n=this._fromCamelCase(e),i=this._fromStyleString(),s=!1,r=0;r<i.length;r++)if(i[r].styleName===n){i[r].styleValue=t,s=!0;break}s||i.push({styleName:n,styleValue:t});var a=this._toStyleString(i);if(this._element._nodeXML.setAttribute("style",a),this._element._attributes._style=a,isIE){var o=this._element._htcNode.style;if(!s){try{o.length++}catch(l){}this.length++}this._ignoreStyleChanges=!0,o[e]=t,this._ignoreStyleChanges=!1}if(this._element._attached&&this._element._passThrough){var c=FlashHandler._encodeFlashData(t);this._element._handler.sendToFlash("jsSetAttribute",[this._element._guid,!0,null,n,c])}},_getStyleAttribute:function(e){var t=this._fromCamelCase(e);if(this._element._attached&&this._element._passThrough&&!this._element._handler._redrawManager.isSuspended()){var n=this._element._handler.sendToFlash("jsGetAttribute",[this._element._guid,!0,!1,null,t,!1]);return n}for(var i=this._fromStyleString(),s=0;s<i.length;s++)if(i[s].styleName===t)return i[s].styleValue;return null},_fromStyleString:function(){var e=this._element._nodeXML.getAttribute("style");if(null===e||void 0===e)return[];var t;-1==e.indexOf(";")?t=[e]:(t=e.split(/\s*;\s*/),t[t.length-1]||(t=t.slice(0,t.length-1)));for(var n=[],i=0;i<t.length;i++){var s=t[i],r=s.split(":");if(2==r.length){var a=r[0],o=r[1];a=a.replace(/^\s+/,""),o=o.replace(/^\s+/,"");var l={styleName:a,styleValue:o};n.push(l)}}return n},_toStyleString:function(e){for(var t="",n=0;n<e.length;n++)t+=e[n].styleName+": ",t+=e[n].styleValue+";",n!=e.length-1&&(t+=" ");return t},_fromCamelCase:function(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()},_toCamelCase:function(e){if(-1==e.indexOf("-"))return e;var t="",n=e.split("-");t+=n[0];for(var i=1;i<n.length;i++)t+=n[i].charAt(0).toUpperCase()+n[i].substring(1);return t},setProperty:function(e,t){var n=this._toCamelCase(e);return this._setStyleAttribute(n,t),t},getPropertyValue:function(e){var t=this._toCamelCase(e);return this._getStyleAttribute(t)},item:function(e){var t=this._fromStyleString();return t[e].styleName},_getLength:function(){var e=this._fromStyleString();return e.length},_normalizeStyle:function(){if(this._element._nodeXML.getAttribute("style")&&/[A-Z]/.test(this._element._nodeXML.getAttribute("style"))){for(var e=this._fromStyleString(),t=0;t<e.length;t++)e[t].styleName=e[t].styleName.toLowerCase(),-1==e[t].styleValue.indexOf("url(")&&(e[t].styleValue=e[t].styleValue.toLowerCase());for(var n="",t=0;t<e.length;t++)n+=e[t].styleName+": "+e[t].styleValue+"; ";" "==n.charAt(n.length-1)&&(n=n.substring(0,n.length-1)),this._element._passThrough=!1,this._element.setAttribute("style",n),this._element._passThrough=!0}},_onPropertyChange:function(){if(!this._ignoreStyleChanges){var e=window.event.propertyName;if(e&&/^style\./.test(e)&&"style.length"!=e){var t=e.match(/^style\.(.*)$/)[1],n=this._element._htcNode.style[t];this._setStyleAttribute(t,n)}}}}),extend(_SVGObject,{_scriptsToExec:null,_utf8encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);128>i?t+=String.fromCharCode(i):i>127&&2048>i?(t+=escape(String.fromCharCode(192|i>>6)),t+=escape(String.fromCharCode(128|63&i))):(t+=escape(String.fromCharCode(224|i>>12)),t+=escape(String.fromCharCode(128|63&i>>6)),t+=escape(String.fromCharCode(128|63&i)))}return t},_fetchURL:function(e,t,n){var i=xhrObj();isIE&&(e=this._utf8encode(e),e+=-1==e.indexOf("?")?"?":"&",e+=(new Date).getTime()),i.onreadystatechange=function(){4==i.readyState&&(200==i.status?t(i.responseText):n(i.status+": "+i.statusText),i=null)},i.open("GET",e,!0),i.send(null)},_fallback:function(e){console.log("onError (fallback), error="+e)},_loadHTC:function(){this._dummyNode=document.createElement("svg:__force__load"),this._dummyNode._handler=this._handler,this._readyStateListener=hitch(this,this._onHTCLoaded),this._dummyNode.attachEvent("onreadystatechange",this._readyStateListener);var e=document.getElementsByTagName("head")[0];e.appendChild(this._dummyNode)},_onFlashLoaded:function(e){document.getElementById(this._handler.flashID)?this._onFlashLoadedNow(e):setTimeout(function(e,t){return function(){e._onFlashLoaded(t)}}(this,e),1)},_onFlashLoadedNow:function(){if(this._handler.flash=document.getElementById(this._handler.flashID),this._savedParams.length){for(var e=0;e<this._savedParams.length;e++){var t=this._savedParams[e];this._handler.flash.appendChild(t),t=null}this._savedParams=null}this._handler.flash.top=this._handler.flash.parent=window,this._swfLoaded=!0,(!isIE||this._htcLoaded)&&this._onEverythingLoaded()},_onHTCLoaded:function(){var e=document.getElementsByTagName("head")[0];e.removeChild(this._dummyNode),this._dummyNode.detachEvent("onreadystatechange",this._readyStateListener),this._dummyNode=null,e=null,this._htcLoaded=!0,this._swfLoaded&&this._onEverythingLoaded()},_onEverythingLoaded:function(){var e=this._handler._inserter._determineSize();this._handler.sendToFlash("jsHandleLoad",[this._getRelativeTo("object"),this._getRelativeTo("page"),e.pixelsWidth,e.pixelsHeight,!1,this._svgString])},_onRenderingFinished:function(){this._handler.flash.style.visibility="visible";var e=this._xml.documentElement,t=e.getAttribute("id"),n=new _SVGSVGElement(e,null,null,this._handler),i=this._handler.document;i._attached=!0,i.documentElement=n._getProxyNode(),i.rootElement=n._getProxyNode(),i._nodeById["_"+t]=n,isIE&&this._handler.flash.setAttribute("contentDocument",null);try{this._handler.flash.contentDocument=i}catch(s){try{this._handler.flash.__contentDocument=i;var r=this;Object.defineProperty(this._handler.flash,"contentDocument",{get:function(){return r._handler.flash.__contentDocument},set:function(e){r._handler.flash.__contentDocument=e}})}catch(s){console.log("This exception occurred setting object contentDocument: "+(s.message||s))}}this._handler.window=new _SVGWindow(this._handler),i.defaultView=this._handler.window,FlashHandler._patchFakeObjects(i.defaultView,i);var a=e.getAttribute("onload");if(a){var o='var evt = { target: document.getElementById("'+n.getAttribute("id")+'") ,'+'currentTarget: document.getElementById("'+n.getAttribute("id")+'") ,'+"preventDefault: function() { this.returnValue=false; }"+"};";a=";(function(){"+o+a+"}).apply(document.documentElement);",this._scriptsToExec.push(a)}for(var l="",c=0;c<this._scriptsToExec.length;c++)l+=this._scriptsToExec[c]+"\n";this._executeScript(l),this._handler._loaded=!0,this._handler.fireOnLoad(this._handler.id,"object")},_getRelativeTo:function(e){var t="";if("object"==e){var n=this.url.replace(/[^:]*:\/\/[^\/]*/).match(/\/?[^\?\#]*/)[0];n&&n.length>0&&-1!=n.indexOf("/")&&(t=n.replace(/\/([^\/]*)$/,"/"))}else{var n=window.location.pathname.toString();n&&n.length>0&&-1!=n.indexOf("/")&&(t=n.replace(/\/([^\/]*)$/,"/"))}return t},_executeScript:function(e){var t=document.createElement("iframe");t.setAttribute("src","about:blank"),t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px";var n=document.getElementsByTagName("body")[0];n.appendChild(t);var i=t.contentDocument?t.contentDocument:t.contentWindow.document,s=t.contentWindow;this._handler.document.defaultView=s,e=this._sandboxedScript(e),e=e+";if (__svgHandler) __svgHandler.sandbox_eval = "+(isIE?"window.eval;":"function(scriptCode) { return window.eval(scriptCode) };"),isOpera?setTimeout(function(e,t,n){return function(){t.eval.apply(t,[n]),e._fireOnload()}}(this._handler.window,s,e),1):(i.write("<script>"+e+"</script>"),i.close(),this._handler.window._fireOnload())},_sandboxedScript:function(e){var t="top.svgweb";!top.svgweb&&self.frameElement&&(self.frameElement.id||(self.frameElement.id=svgweb._generateID("__svg__random__","__iframe")),t='top.document.getElementById("'+self.frameElement.id+'").contentWindow.svgweb');var n="var __svgHandler = "+t+'.handlers["'+this._handler.id+'"];\n'+'window.svgns = "'+svgns+'";\n'+'window.xlinkns = "'+xlinkns+'";\n',i="window._timeoutIDs = [];\nwindow._setTimeout = window.setTimeout;\nwindow.setTimeout = \n       (function() {\n          return function(f, ms) {\n            var timeID = window._setTimeout(f, ms);\n            window._timeoutIDs.push(timeID);\n            return timeID;\n          };\n        })();\n",s="window._intervalIDs = [];\nwindow._setInterval = window.setInterval;\nwindow.setInterval = \n       (function() {\n          return function(f, ms) {\n            var timeID = window._setInterval(f, ms);\n            window._intervalIDs.push(timeID);\n            return timeID;\n          };\n        })();\n";return e=n+i+s+"\n\n"+e,e=e.replace(/top\.document/g,"top.DOCUMENT"),e=e.replace(/top\.window/g,"top.WINDOW"),e=e.replace(/(^|[^A-Za-z0-9_])document(\.|'|"|\,| |\))/g,"$1__svgHandler.document$2"),e=e.replace(/window\.(location|addEventListener|onload|frameElement)/g,"__svgHandler.window.$1"),e=e.replace(/top\.DOCUMENT/g,"top.document"),e=e.replace(/top\.WINDOW/g,"top.window")},_getPARAMs:function(e){for(var t=[],n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];"PARAM"==i.nodeName.toUpperCase()&&t.push(i.cloneNode(!1))}return t}}),extend(_SVGWindow,{addEventListener:function(e,t){("svgload"==e.toLowerCase()||"load"==e.toLowerCase())&&this._onloadListeners.push(t)},_fireOnload:function(){for(var e=0;e<this._onloadListeners.length;e++)try{this._onloadListeners[e]()}catch(t){console.log("The following exception occurred from an SVG onload listener: "+(t.message||t))}if(this.onload)try{this.onload()}catch(t){console.log("The following exception occurred from an SVG onload listener: "+(t.message||t))}},_createLocation:function(e){var t,n={},i=this._handler._svgObject.url;if(t=e?e:window.location,/^data:/.test(i))return n.href=i,n.toString=function(){return this.href},n;if(/^http/.test(i));else if("/"==i.charAt(0))i=t.protocol+"//"+t.host+i;else if(-1==t.pathname.indexOf("/"))i=t.protocol+"//"+t.host+"/"+i;else{for(var s=t.pathname,r=s.length-1;r>=0&&"/"!=s.charAt(r);r--)s=s.substring(0,r);i=t.protocol+"//"+t.host+s+i}var a=i.match(/^(https?:)\/\/([^\/:]*):?([0-9]*)([^\?#]*)([^#]*)(#.*)?$/);n.protocol=a[1]?a[1]:t.href,":"!=n.protocol.charAt(n.protocol.length-1)&&(n.protocol+=":"),n.hostname=a[2],n.port="",a[3]&&(n.port=a[3]);var o=!0;return(n.protocol!=t.protocol||n.hostname!=t.hostname||n.port&&n.port!=t.port)&&(o=!1),o&&!n.port&&(n.port=t.port),n.host=n.port?n.hostname+":"+n.port:n.hostname,n.pathname=a[4]?a[4]:"",n.search=a[5]?a[5]:"",n.hash=a[6]?a[6]:"",n.href=n.protocol+"//"+n.host+n.pathname+n.search+n.hash,n.toString=function(){return this.protocol+"//"+this.host+this.pathname+this.search+this.hash},n}}),extend(FlashInserter,{_setupFlash:function(){var e,t=this._determineSize(),n=this._determineBackground(),i=this._determineStyle(),s=this._determineClassName(),r=this._determineCustomAttrs();"script"==this._embedType?(e=this._nodeXML.getAttribute("id"),this._handler.flashID=e+"_flash"):"object"==this._embedType&&(e=this._replaceMe.getAttribute("id"),this._handler.flashID=e);var a=this._createFlash(t,e,n,i,s,r);this._insertFlash(a)},_insertFlash:function(e){if(!isIE){var t;if(isXHTML)isXHTML&&(t=e);else{var n=document.createElement("div");n.innerHTML=e,t=n.childNodes[0],n.removeChild(t);for(var i=0;i<t.childNodes.length;i++){var s=t.childNodes[i];if("EMBED"==s.nodeName.toUpperCase()){t=s;break}}}return this._replaceMe.parentNode.replaceChild(t,this._replaceMe),t}var r=this;window.setTimeout(function(){r._replaceMe.removeAttribute("id"),r._replaceMe.removeAttribute("name"),r._replaceMe.outerHTML=e,r=null},1)},_determineSize:function(){var e=this._parentNode.clientWidth,t=this._parentNode.clientHeight;return 0==t&&(this.invalidParentHeight=!0),0==e&&(e=this._parentNode.offsetWidth),isSafari||(e-=this._getMargin(this._parentNode,"margin-left"),e-=this._getMargin(this._parentNode,"margin-right"),t-=this._getMargin(this._parentNode,"margin-top"),t-=this._getMargin(this._parentNode,"margin-bottom")),isStandardsMode?this._getStandardsSize(e,t):this._getQuirksSize(e,t)},_getQuirksSize:function(e,t){var n,i;
if("script"==this._embedType)for(var s=this._parentNode;s&&s.style&&"div"!=s.nodeName.toLowerCase();){if("body"==s.nodeName.toLowerCase()){this._nodeXML.getAttribute("style")&&-1!=this._nodeXML.getAttribute("style").indexOf("fixed")?(t=window.innerHeight&&window.innerHeight>0?window.innerHeight:document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientHeight>0?document.documentElement.clientHeight:document.body.clientHeight,this.invalidParentHeight=!1):(this.invalidParentHeight=!0,t=0);break}s=s.parentNode}var r=this._explicitWidth,a=this._explicitHeight,o=this._nodeXML.getAttribute("width");o&&-1==o.indexOf("%")&&(o=parseInt(o).toString());var l=this._nodeXML.getAttribute("height");if(l&&-1==l.indexOf("%")&&(l=parseInt(l).toString()),r&&a)return n=-1!=r.indexOf("%")?e*parseInt(r)/100:r,-1!=a.indexOf("%")?t>0?i=t*parseInt(a)/100:(console.log("SVGWeb: unhandled resize scenario."),t=200):i=a,{width:r,height:i,pixelsWidth:n,pixelsHeight:i,clipMode:this._nodeXML.getAttribute("viewBox")?"neither":"both"};var c,d,u;if(r)return n=-1!=r.indexOf("%")?e*parseInt(r)/100:r,this._nodeXML.getAttribute("viewBox")?(o&&-1==o.indexOf("%")&&l&&-1==l.indexOf("%")?a=n*(l/o):(c=this._nodeXML.getAttribute("viewBox").split(/\s+|,/),d=c[2],u=c[3],a=n*(u/d)),{width:r,height:a,pixelsWidth:n,pixelsHeight:a,clipMode:"neither"}):(a=o&&-1==o.indexOf("%")&&l&&-1==l.indexOf("%")?n*(l/o):l&&-1==l.indexOf("%")?l:150,{width:r,height:a,pixelsWidth:n,pixelsHeight:a,clipMode:"both"});if(a)return i=-1!=a.indexOf("%")?t*parseInt(a)/100:a,this._nodeXML.getAttribute("viewBox")?(o&&-1==o.indexOf("%")&&l&&-1==l.indexOf("%")?r=i*(o/l):(c=this._nodeXML.getAttribute("viewBox").split(/\s+|,/),d=c[2],u=c[3],r=i*(d/u)),{width:r,height:a,pixelsWidth:r,pixelsHeight:i,clipMode:"neither"}):(o&&-1==o.indexOf("%")&&l&&-1==l.indexOf("%")?(r=i*(o/l),n=r):(r=o?o:"100%",n=-1!=r.indexOf("%")?e*parseInt(r)/100:r),{width:r,height:a,pixelsWidth:n,pixelsHeight:i,clipMode:"both"});if(r=o?o:"100%",n=-1!=r.indexOf("%")?e*parseInt(r)/100:r,l&&-1==l.indexOf("%"))return a=l,{width:r,height:a,pixelsWidth:n,pixelsHeight:a,clipMode:this._nodeXML.getAttribute("viewBox")?"neither":"both"};if(this._nodeXML.getAttribute("viewBox")){if("script"==this._embedType&&(null==l||-1!=l.indexOf("%"))&&!this.invalidParentHeight)return null==l&&(l="100%"),null==a&&(a="100%"),i=t*parseInt(l)/100,{width:r,height:i,pixelsWidth:n,pixelsHeight:i,clipMode:"neither"};var c=this._nodeXML.getAttribute("viewBox").split(/\s+|,/),d=c[2],u=c[3];return a=n*(u/d),{width:r,height:a,pixelsWidth:n,pixelsHeight:a,clipMode:"neither"}}return a=150,{width:r,height:a,pixelsWidth:n,pixelsHeight:a,clipMode:"both"}},_getStandardsSize:function(e,t){var n,i,s=this._explicitWidth,r=this._explicitHeight,a=this._nodeXML.getAttribute("width");a&&-1==a.indexOf("%")&&(a=parseInt(a).toString());var o=this._nodeXML.getAttribute("height");return o&&-1==o.indexOf("%")&&(o=parseInt(o).toString()),s&&!r?this._getQuirksSize(e,t):s||r?!s&&r?(s=a?a:"100%",n=-1!=s.indexOf("%")?e*parseInt(s)/100:s,-1==r.indexOf("%")?(i=r,a&&-1==a.indexOf("%")&&o&&-1==o.indexOf("%")?(s=r*(a/o),n=s):this._nodeXML.getAttribute("viewBox")&&(viewBox=this._nodeXML.getAttribute("viewBox").split(/\s+|,/),boxWidth=viewBox[2],boxHeight=viewBox[3],s=i*(boxWidth/boxHeight),n=s),{width:s,height:r,pixelsWidth:n,pixelsHeight:r,clipMode:this._nodeXML.getAttribute("viewBox")?"neither":"both"}):(o&&-1==o.indexOf("%")?i=o:this._nodeXML.getAttribute("viewBox")?(viewBox=this._nodeXML.getAttribute("viewBox").split(/\s+|,/),boxWidth=viewBox[2],boxHeight=viewBox[3],i=n*(boxHeight/boxWidth)):i=150,{width:s,height:i,pixelsWidth:n,pixelsHeight:i,clipMode:this._nodeXML.getAttribute("viewBox")?"neither":"both"})):s&&r?(n=-1!=s.indexOf("%")?e*parseInt(s)/100:s,-1==r.indexOf("%")?{width:s,height:r,pixelsWidth:n,pixelsHeight:r,clipMode:this._nodeXML.getAttribute("viewBox")?"neither":"both"}:a&&-1==a.indexOf("%")&&o&&-1==o.indexOf("%")?(i=n*(o/a),{width:s,height:i,pixelsWidth:n,pixelsHeight:i,clipMode:"neither"}):this.invalidParentHeight?this._nodeXML.getAttribute("viewBox")?(viewBox=this._nodeXML.getAttribute("viewBox").split(/\s+|,/),boxWidth=viewBox[2],boxHeight=viewBox[3],r=n*(boxHeight/boxWidth),{width:s,height:r,pixelsWidth:n,pixelsHeight:r,clipMode:"neither"}):(i=o&&-1==o.indexOf("%")?o:150,{width:s,height:i,pixelsWidth:n,pixelsHeight:i,clipMode:"both"}):(i=t*parseInt(r)/100,{width:s,height:i,pixelsWidth:n,pixelsHeight:i,clipMode:"neither"})):void 0:this._getQuirksSize(e,t)},_getMargin:function(e,t){var n;return e.currentStyle?n=parseInt(e.currentStyle[t]):window.getComputedStyle&&(n=parseInt(document.defaultView.getComputedStyle(e,null).getPropertyValue(t))),n?n:0},_determineBackground:function(){var e=!1,t=null,n=this._nodeXML.getAttribute("style");if(n&&-1!=n.indexOf("background-color")){var i=n.match(/background\-color:\s*([^;]*)/);i&&(t=i[1])}return null===t&&(e=!0),{color:t,transparent:e}},_determineStyle:function(){var e=this._nodeXML.getAttribute("style");return e||(e=""),e.length>0&&";"!=e.charAt(e.length-1)&&(e+=";"),"script"==this._embedType&&-1==e.indexOf("display:")&&(e+="display: inline;"),"script"==this._embedType&&-1==e.indexOf("overflow:")&&(e+="overflow: hidden;"),e},_determineClassName:function(){var e=this._nodeXML.getAttribute("class");return e?e+" embedssvg":"embedssvg"},_determineCustomAttrs:function(){var e=[];if("object"==this._embedType)for(var t=this._replaceMe,n=document._createElement("object"),i=0;i<t.attributes.length;i++){var s=t.attributes[i],r=s.nodeName,a=s.nodeValue;(a||"true"===a)&&(n.getAttribute(r)||/^(id|name|width|height|data|class|style|codebase|type|_listeners|addEventListener|onload)$/.test(r)||e.push({attrName:r.toString(),attrValue:a.toString()}))}return e},_createFlash:function(e,t,n,i,s,r){for(var a,o="uniqueId="+encodeURIComponent(t)+"&sourceType=string"+"&clipMode="+e.clipMode+"&debug=true"+"&svgId="+encodeURIComponent(t),l=document.getElementsByTagName("script"),c=0;c<l.length;c++)if(/svg(?:\-uncompressed|\-[0-9a-fA-F]+)?\.js/.test(l[c].src)&&l[c].getAttribute("data-swf-path")){swfPath=l[c].getAttribute("data-swf-path");break}a=void 0!=swfPath?swfPath:this._isXDomain?svgweb.xDomainURL+"svg.swf":svgweb.libraryPath+"svg.swf";var d=window.location.protocol;":"==d.charAt(d.length-1)&&(d=d.substring(0,d.length-1));var u;if(isXHTML){u=document.createElement("embed"),u.setAttribute("src",a),u.setAttribute("quality","high"),n.color&&u.setAttribute("bgcolor",n.color),n.transparent&&u.setAttribute("wmode","transparent"),u.setAttribute("width",e.width),u.setAttribute("height",e.height),u.setAttribute("id",this._handler.flashID),u.setAttribute("name",this._handler.flashID),u.setAttribute("swLiveConnect","true"),u.setAttribute("allowScriptAccess","always"),u.setAttribute("type","application/x-shockwave-flash"),u.setAttribute("FlashVars",o),u.setAttribute("pluginspage",d+"://www.macromedia.com/go/getflashplayer"),u.setAttribute("style",i),u.setAttribute("className",s);for(var c=0;c<r.length;c++)u.setAttribute(r[c].attrName,r[c].attrValue)}else{for(var h="",c=0;c<r.length;c++)h+=" "+r[c].attrName+'="'+r[c].attrValue+'"';u='<object\n classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"\n codebase="'+d+"://fpdownload.macromedia.com/pub/shockwave/cabs/flash/"+'swflash.cab#version=10,0,0,0"\n '+'width="'+e.width+'"\n '+'height="'+e.height+'"\n '+'id="'+this._handler.flashID+'"\n '+'name="'+this._handler.flashID+'"\n '+'style="'+i+'"\n '+'class="'+s+'"\n '+h+"\n"+">\n "+'<param name="allowScriptAccess" value="always"></param>\n '+'<param name="movie" value="'+a+'"></param>\n '+'<param name="quality" value="high"></param>\n '+'<param name="FlashVars" value="'+o+'"></param>\n '+(n.color?'<param name="bgcolor" value="'+n.color+'"></param>\n ':"")+(n.transparent?'<param name="wmode" value="transparent"></param>\n ':"")+"<embed "+'src="'+a+'" '+'quality="high" '+(n.color?'bgcolor="'+n.color+'" \n':"")+(n.transparent?'wmode="transparent" \n':"")+'width="'+e.width+'" '+'height="'+e.height+'" '+'id="'+this._handler.flashID+'" '+'name="'+this._handler.flashID+'" '+'swLiveConnect="true" '+'allowScriptAccess="always" '+'type="application/x-shockwave-flash" '+'FlashVars="'+o+'" '+'pluginspage="'+d+'://www.macromedia.com/go/getflashplayer" '+'style="'+i+'"\n '+'class="'+s+'"\n '+h+"\n"+" />"+"</object>"}return u}}),_SVGSVGElement.prototype=new _Element,extend(_SVGSVGElement,{suspendRedraw:function(e){return this._handler._redrawManager.suspendRedraw(e)},unsuspendRedraw:function(e){this._handler._redrawManager.unsuspendRedraw(e)},unsuspendRedrawAll:function(){this._handler._redrawManager.unsuspendRedrawAll()},forceRedraw:function(){},nearestViewportElement:null,farthestViewportElement:null,getTransformToElement:function(){},_onHTCLoaded:function(){this._htcNode.detachEvent("onreadystatechange",this._readyStateListener),this.style._ignoreStyleChanges=!1,this._htcLoaded=!0,this._swfLoaded&&this._onEverythingLoaded()},_onFlashLoaded:function(e){document.getElementById(this._handler.flashID)?this._onFlashLoadedNow(e):setTimeout(function(e,t){return function(){e._onFlashLoaded(t)}}(this,e),1)},_onFlashLoadedNow:function(){this._handler.flash=document.getElementById(this._handler.flashID),this._swfLoaded=!0,(!isIE||this._htcLoaded)&&this._onEverythingLoaded()},_onEverythingLoaded:function(){var e=this._handler._inserter._determineSize();this._handler.sendToFlash("jsHandleLoad",[this._getRelativeTo("object"),this._getRelativeTo("page"),e.pixelsWidth,e.pixelsHeight,!0,this._svgString])},_onRenderingFinished:function(){"script"==this._handler.type&&(this._handler.flash.documentElement=this._getProxyNode()),this._attached&&("script"==this._handler.type?this.ownerDocument=document:"object"==this._handler.type&&(this.ownerDocument=this._handler.document)),this._handler.document.rootElement=this._getProxyNode();var e=this._nodeXML.getAttribute("id");this._handler._loaded=!0,this._handler.fireOnLoad(e,"script")},_getRelativeTo:function(){var e="",t=window.location.pathname.toString();return t&&t.length>0&&-1!=t.indexOf("/")&&(e=t.replace(/\/([^\/]*)$/,"/")),e},_addRedrawMethods:function(){this._htcNode.suspendRedraw=function(){return function(e){return this._fakeNode.suspendRedraw(e)}}(),this._htcNode.unsuspendRedraw=function(){return function(e){return this._fakeNode.unsuspendRedraw(e)}}(),this._htcNode.unsuspendRedrawAll=function(){return function(){return this._fakeNode.unsuspendRedrawAll()}}(),this._htcNode.forceRedraw=function(){return function(){return this._fakeNode.forceRedraw()}}()},_createCurrentTranslate:function(){var e=new _SVGPoint(0,0,!0,hitch(this,this._updateCurrentTranslate));return e},_updateCurrentTranslate:function(e,t,n){"xy"==e?this._handler.sendToFlash("jsSetCurrentTranslate",["xy",t,n]):this._handler.sendToFlash("jsSetCurrentTranslate",[e,t])}}),_Document.prototype=new _Node,extend(_Document,{_nodeById:null,implementation:null,documentElement:null,createElementNS:function(e,t){var n=this._namespaces["_"+e];"xmlns"!=n&&n||(n=-1!=t.indexOf(":")?t.substring(0,t.indexOf(":")):null);var i=new _Element(t,n,e,void 0,this._handler);return i._getProxyNode()},createTextNode:function(e){var t,n=FlashHandler._unattachedDoc;t=isIE?n.createElement("__text"):n.createElementNS(svgnsFake,"__text"),t.appendChild(n.createTextNode(e));var i=new _Node("#text",_Node.TEXT_NODE,null,null,t,this._handler);return i._nodeValue=e,i.ownerDocument=this,i._getProxyNode()},createDocumentFragment:function(){return new _DocumentFragment(this)._getProxyNode()},getElementById:function(e){var t,n,i=xpath(this._xml,null,'//*[@id="'+e+'"]');return i.length?(t=i[0],n=FlashHandler._getNode(t,this._handler),this._getFakeNode(n)._attached=!0,n):null},getElementsByTagNameNS:function(e,t){if("script"==this._handler.type&&!this._handler._loaded)return[];var n=this.rootElement.getElementsByTagNameNS(e,t);if(e==svgns&&"svg"==t){if("undefined"==typeof n.push){var i=n;n=[];for(var s=0;s<i.length;s++)n.push(i[s])}n.push(this.rootElement)}return n},_getNamespaces:function(){for(var e=[],t=this._xml.documentElement.attributes,n=0;n<t.length;n++){var i=t[n];if(/^xmlns:?(.*)$/.test(i.nodeName)){var s=i.nodeName.match(/^xmlns:?(.*)$/),r=s[1]?s[1]:"xmlns",a=i.nodeValue;e["_"+r]||(e["_"+r]=a,e["_"+a]=r,e.push(a))}}return e}}),extend(_SVGMatrix,{multiply:function(){},inverse:function(){var e=this._handler.sendToFlash("jsMatrixInvert",[this.a,this.b,this.c,this.d,this.e,this.f]);return e=this._handler._stringToMsg(e),new _SVGMatrix(new Number(e.a),new Number(e.b),new Number(e.c),new Number(e.d),new Number(e.e),new Number(e.f),this._handler)},translate:function(){},scale:function(){},scaleNonUniform:function(){},rotate:function(){},rotateFromVector:function(){},flipX:function(){},flipY:function(){},skewX:function(){},skewY:function(){}}),mixin(_SVGTransform,{SVG_TRANSFORM_UNKNOWN:0,SVG_TRANSFORM_MATRIX:1,SVG_TRANSFORM_TRANSLATE:2,SVG_TRANSFORM_SCALE:3,SVG_TRANSFORM_ROTATE:4,SVG_TRANSFORM_SKEWX:5,SVG_TRANSFORM_SKEWY:6}),extend(_SVGTransform,{type:null,matrix:null,angle:null,setMatrix:function(){},setTranslate:function(){},setScale:function(){},setRotate:function(){},setSkewX:function(){},setSkewY:function(){}}),extend(_SVGPoint,{matrixTransform:function(e){return new _SVGPoint(e.a*this.x+e.c*this.y+e.e,e.b*this.x+e.d*this.y+e.f,this._formalAccessors)}}),window.svgweb=new SVGWeb}();