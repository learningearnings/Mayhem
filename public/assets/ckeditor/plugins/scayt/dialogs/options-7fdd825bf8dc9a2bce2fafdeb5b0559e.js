/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
CKEDITOR.dialog.add("scaytcheck",function(e){function t(){return"undefined"!=typeof document.forms["optionsbar_"+p]?document.forms["optionsbar_"+p].options:[]}function n(){return"undefined"!=typeof document.forms["languagesbar_"+p]?document.forms["languagesbar_"+p].scayt_lang:[]}function i(e,t){if(e){var n=e.length;if(void 0==n)return e.checked=e.value==t.toString(),void 0;for(var i=0;n>i;i++)e[i].checked=!1,e[i].value==t.toString()&&(e[i].checked=!0)}}function a(e){h.getById("dic_message_"+p).setHtml('<span style="color:red;">'+e+"</span>")}function o(e){h.getById("dic_message_"+p).setHtml('<span style="color:blue;">'+e+"</span>")}function r(e){e=String(e);for(var t=e.split(","),n=0,i=t.length;i>n;n+=1)h.getById(t[n]).$.style.display="inline"}function s(e){e=String(e);for(var t=e.split(","),n=0,i=t.length;i>n;n+=1)h.getById(t[n]).$.style.display="none"}function l(e){h.getById("dic_name_"+p).$.value=e}var d,c,u=!0,h=CKEDITOR.document,p=e.name,m=CKEDITOR.plugins.scayt.getUiTabs(e),g=[],f=0,v=["dic_create_"+p+",dic_restore_"+p,"dic_rename_"+p+",dic_delete_"+p],b=["mixedCase","mixedWithDigits","allCaps","ignoreDomainNames"],y=e.lang.scayt,k=[{id:"options",label:y.optionsTab,elements:[{type:"html",id:"options",html:'<form name="optionsbar_'+p+'"><div class="inner_options">'+'	<div class="messagebox"></div>'+'	<div style="display:none;">'+'		<input type="checkbox" name="options"  id="allCaps_'+p+'" />'+'		<label for="allCaps" id="label_allCaps_'+p+'"></label>'+"	</div>"+'	<div style="display:none;">'+'		<input name="options" type="checkbox"  id="ignoreDomainNames_'+p+'" />'+'		<label for="ignoreDomainNames" id="label_ignoreDomainNames_'+p+'"></label>'+"	</div>"+'	<div style="display:none;">'+'	<input name="options" type="checkbox"  id="mixedCase_'+p+'" />'+'		<label for="mixedCase" id="label_mixedCase_'+p+'"></label>'+"	</div>"+'	<div style="display:none;">'+'		<input name="options" type="checkbox"  id="mixedWithDigits_'+p+'" />'+'		<label for="mixedWithDigits" id="label_mixedWithDigits_'+p+'"></label>'+"	</div>"+"</div></form>"}]},{id:"langs",label:y.languagesTab,elements:[{type:"html",id:"langs",html:'<form name="languagesbar_'+p+'"><div class="inner_langs">'+'	<div class="messagebox"></div>	'+'   <div style="float:left;width:45%;margin-left:5px;" id="scayt_lcol_'+p+'" ></div>'+'   <div style="float:left;width:45%;margin-left:15px;" id="scayt_rcol_'+p+'"></div>'+"</div></form>"}]},{id:"dictionaries",label:y.dictionariesTab,elements:[{type:"html",style:"",id:"dictionaries",html:'<form name="dictionarybar_'+p+'"><div class="inner_dictionary" style="text-align:left; white-space:normal; width:320px; overflow: hidden;">'+'	<div style="margin:5px auto; width:80%;white-space:normal; overflow:hidden;" id="dic_message_'+p+'"> </div>'+'	<div style="margin:5px auto; width:80%;white-space:normal;"> '+'       <span class="cke_dialog_ui_labeled_label" >Dictionary name</span><br>'+'		<span class="cke_dialog_ui_labeled_content" >'+'			<div class="cke_dialog_ui_input_text">'+'				<input id="dic_name_'+p+'" type="text" class="cke_dialog_ui_input_text"/>'+"		</div></span></div>"+'		<div style="margin:5px auto; width:80%;white-space:normal;">'+'			<a style="display:none;" class="cke_dialog_ui_button" href="javascript:void(0)" id="dic_create_'+p+'">'+"				</a>"+'			<a  style="display:none;" class="cke_dialog_ui_button" href="javascript:void(0)" id="dic_delete_'+p+'">'+"				</a>"+'			<a  style="display:none;" class="cke_dialog_ui_button" href="javascript:void(0)" id="dic_rename_'+p+'">'+"				</a>"+'			<a  style="display:none;" class="cke_dialog_ui_button" href="javascript:void(0)" id="dic_restore_'+p+'">'+"				</a>"+"		</div>"+'	<div style="margin:5px auto; width:95%;white-space:normal;" id="dic_info_'+p+'"></div>'+"</div></form>"}]},{id:"about",label:y.aboutTab,elements:[{type:"html",id:"about",style:"margin: 5px 5px;",html:'<div id="scayt_about_'+p+'"></div>'}]}],_={title:y.title,minWidth:360,minHeight:220,onShow:function(){var t=this;if(t.data=e.fire("scaytDialog",{}),t.options=t.data.scayt_control.option(),t.chosed_lang=t.sLang=t.data.scayt_control.sLang,!t.data||!t.data.scayt||!t.data.scayt_control)return alert("Error loading application service"),t.hide(),void 0;var n=0;u?t.data.scayt.getCaption(e.langCode||"en",function(e){n++>0||(d=e,w.apply(t),C.apply(t),u=!1)}):C.apply(t),t.selectPage(t.data.tab)},onOk:function(){var e=this.data.scayt_control;e.option(this.options);var t=this.chosed_lang;e.setLang(t),e.refresh()},onCancel:function(){var e=t();for(var a in e)e[a].checked=!1;i(n(),"")},contents:g};for(CKEDITOR.plugins.scayt.getScayt(e),c=0;c<m.length;c++)1==m[c]&&(g[g.length]=k[c]);1==m[2]&&(f=1);var w=function(){function e(e){var t=h.getById("dic_name_"+p).getValue();if(!t)return a(" Dictionary name should not be empty. "),!1;try{var n=e.data.getTarget().getParent(),i=/(dic_\w+)_[\w\d]+/.exec(n.getId())[1];D[i].apply(null,[n,t,v])}catch(o){a(" Dictionary error. ")}return!0}var t,n=this,i=n.data.scayt.getLangList(),c=["dic_create","dic_delete","dic_rename","dic_restore"],u=[],g=[],y=b;if(f){for(t=0;t<c.length;t++)u[t]=c[t]+"_"+p,h.getById(u[t]).setHtml('<span class="cke_dialog_ui_button">'+d["button_"+c[t]]+"</span>");h.getById("dic_info_"+p).setHtml(d.dic_info)}if(1==m[0])for(t in y){var k="label_"+y[t],_=k+"_"+p,w=h.getById(_);if("undefined"!=typeof w&&"undefined"!=typeof d[k]&&"undefined"!=typeof n.options[y[t]]){w.setHtml(d[k]);var C=w.getParent();C.$.style.display="block"}}var T='<p><img src="'+window.scayt.getAboutInfo().logoURL+'" /></p>'+"<p>"+d.version+window.scayt.getAboutInfo().version.toString()+"</p>"+"<p>"+d.about_throwt_copy+"</p>";h.getById("scayt_about_"+p).setHtml(T);var x=function(e,t){var i=h.createElement("label");i.setAttribute("for","cke_option"+e),i.setHtml(t[e]),n.sLang==e&&(n.chosed_lang=e);var a=h.createElement("div"),o=CKEDITOR.dom.element.createFromHtml('<input id="cke_option'+e+'" type="radio" '+(n.sLang==e?'checked="checked"':"")+' value="'+e+'" name="scayt_lang" />');return o.on("click",function(){this.$.checked=!0,n.chosed_lang=e}),a.append(o),a.append(i),{lang:t[e],code:e,radio:a}};if(1==m[1]){for(t in i.rtl)g[g.length]=x(t,i.ltr);for(t in i.ltr)g[g.length]=x(t,i.ltr);g.sort(function(e,t){return t.lang>e.lang?-1:1});var S=h.getById("scayt_lcol_"+p),E=h.getById("scayt_rcol_"+p);for(t=0;t<g.length;t++){var A=t<g.length/2?S:E;A.append(g[t].radio)}}var D={};D.dic_create=function(e,t,n){var i=n[0]+","+n[1],l=d.err_dic_create,c=d.succ_dic_create;window.scayt.createUserDictionary(t,function(e){s(i),r(n[1]),c=c.replace("%s",e.dname),o(c)},function(e){l=l.replace("%s",e.dname),a(l+"( "+(e.message||"")+")")})},D.dic_rename=function(e,t){var n=d.err_dic_rename||"",i=d.succ_dic_rename||"";window.scayt.renameUserDictionary(t,function(e){i=i.replace("%s",e.dname),l(t),o(i)},function(e){n=n.replace("%s",e.dname),l(t),a(n+"( "+(e.message||"")+" )")})},D.dic_delete=function(e,t,n){var i=n[0]+","+n[1],c=d.err_dic_delete,u=d.succ_dic_delete;window.scayt.deleteUserDictionary(function(e){u=u.replace("%s",e.dname),s(i),r(n[0]),l(""),o(u)},function(e){c=c.replace("%s",e.dname),a(c)})},D.dic_restore=n.dic_restore||function(e,t,n){var i=n[0]+","+n[1],l=d.err_dic_restore,c=d.succ_dic_restore;window.scayt.restoreUserDictionary(t,function(e){c=c.replace("%s",e.dname),s(i),r(n[1]),o(c)},function(e){l=l.replace("%s",e.dname),a(l)})};var N,I=(v[0]+","+v[1]).split(",");for(t=0,N=I.length;N>t;t+=1){var L=h.getById(I[t]);L&&L.on("click",e,this)}},C=function(){var e=this;if(1==m[0])for(var n=t(),a=0,l=n.length;l>a;a++){var d=n[a].id,c=h.getById(d);c&&(n[a].checked=!1,1==e.options[d.split("_")[0]]&&(n[a].checked=!0),u&&c.on("click",function(){e.options[this.getId().split("_")[0]]=this.$.checked?1:0}))}if(1==m[1]){var g=h.getById("cke_option"+e.sLang);i(g.$,e.sLang)}f&&(window.scayt.getNameUserDictionary(function(e){var t=e.dname;s(v[0]+","+v[1]),t?(h.getById("dic_name_"+p).setValue(t),r(v[1])):r(v[0])},function(){h.getById("dic_name_"+p).setValue("")}),o(""))};return _});